!function(t,e){"function"==typeof define&&define.amd?define("other/Audio.js",["d3","../common/HTMLWidget"],e):t.other_Audio=e(t.d3,t.common_HTMLWidget)}(this,function(t,e){function o(){e.call(this),this._tag="audio",this._sections={}}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" other_Audio",o.prototype.publish("source","","string","Audio Source"),o.prototype.section=function(t,e,o,i){return arguments.length?1===arguments.length?this._sections[t]:(this._sections[t]={label:t,offset:e,beatLength:o,beatCount:i,endOffset:e+i*o},this):this._sections},o.prototype.getType=function(t){switch(t){case"mp3":return"audio/mpeg; codecs='mp3'";case"ogg":return"audio/ogg; codecs='vorbis'"}return""},o.prototype.enter=function(t,e){var o=this;e.on("play",function(t){o.onPlay(t)})},o.prototype.update=function(t,e){var o=e.selectAll("source").data(this.source(),function(t){return t});o.enter().append("source").attr("src",function(t){return t})},o.prototype.createTimer=function(e,o,i){var r=this;t.timer(function(){return r.onTick(e.label,i,e),!0},i*e.beatLength,o+e.offset)},o.prototype.onTick=function(t,e,o){},o.prototype.onPlay=function(t){var e=Date.now();for(var o in this._sections)for(var i=this._sections[o],r=0;r<i.beatCount;++r)this.createTimer(i,e,r)},o.prototype.play=function(t){var e=this;this._element.on("canplaythrough",function(t){e.node().play()}),this.node().load()},o}),function(t,e){"function"==typeof define&&define.amd?define("other/Comms.js",["es6-promise"],e):t.other_Comms=e()}(this,function(){function t(t){if(!t.trim)return t;var e=t.trim();return""===e||isNaN(e)?e:Number(e)}function e(e){for(var o in e)e[o]=t(e[o]);return e}function o(){this._protocol="http:",this._hostname="localhost"}function i(t){this._mappings=t,this._reverseMappings={};for(var e in this._mappings){this._reverseMappings[e]={};for(var o in this._mappings[e])this._reverseMappings[e][this._mappings[e][o]]=o}}function r(){o.call(this),this._proxyMappings={},this._mappings=new i({}),this._timeout=60}function s(t,e){if(!t||!e)return!1;for(var o=t.split("."),i=e,r=0;r<o.length;++r){var s=o[r];if(void 0===i[s])return!1;i=i[s]}return!0}function n(){r.call(this)}function a(){r.call(this),this._port="8002",this._target="",this._query=""}function l(){r.call(this),this._port="8010",this._wuid="",this._jobname="",this._sequence=null,this._resultName=null,this._resultNameCache={},this._resultNameCacheCount=0}function p(){r.call(this),this._port="8010",this._wuid=null}function u(){r.call(this)}function h(){l.call(this),this._hipieResults={}}function c(){h.call(this)}o.prototype.url=function(t){if(!arguments.length)return this._url;this._url=t;var e=document.createElement("a");e.href=this._url,e.href=e.href;var o={};if(e.search.length){var i=e.search;"?"===i[0]&&(i=i.substring(1)),i=i.split("&"),i.map(function(t){var e=t.split("=");o[decodeURIComponent(e[0])]=decodeURIComponent(e[1])})}for(this._protocol=e.protocol,this._hostname=e.hostname,this._port=e.port,this._pathname=e.pathname;this._pathname.length&&"/"===this._pathname[0];)this._pathname=this._pathname.substring(1);return this._search=e.search,this._params=o,this._hash=e.hash,this._host=e.host,this},o.prototype.protocol=function(t){return arguments.length?(this._protocol=t,this):this._protocol},o.prototype.hostname=function(t){return arguments.length?(this._hostname=t,this):this._hostname},o.prototype.port=function(t){return arguments.length?(this._port=t,this):this._port},o.prototype.pathname=function(t){return arguments.length?(this._pathname=t,this):this._pathname},o.prototype.isWsWorkunits=function(){return this._pathname.toLowerCase().indexOf("wsworkunits")>=0||this._params.Wuid},o.prototype.isWorkunitResult=function(){return this.isWsWorkunits()&&(this._params.Sequence||this._params.ResultName)},o.prototype.isWsEcl=function(){return this._pathname.toLowerCase().indexOf("wsecl")>=0||this._params.QuerySetId&&this._params.Id},o.prototype.isWsWorkunits_GetStats=function(){return this._pathname.toLowerCase().indexOf("wsworkunits/wugetstats")>=0&&this._params.WUID},o.prototype.getUrl=function(t){return t=t||{},(t.protocol?t.protocol:this._protocol)+"//"+(t.hostname?t.hostname:this._hostname)+":"+(t.port?t.port:this._port)+"/"+(t.pathname?t.pathname:this._pathname)},i.prototype.contains=function(t,e){return s(t+"."+e,this._mappings)},i.prototype.mapResult=function(t,e){var o=this._mappings[e];o&&(t[e]=t[e].map(function(t){var e=[];if(o.x&&o.x instanceof Array){e=[];for(var i=0;i<o.x.length;++i)e.push(t[o.y[i]])}else for(var r in o)"label"===o[r]?e[0]=t[r]:"weight"===o[r]&&(e[1]=t[r]);return e},this))},i.prototype.mapResponse=function(t){for(var e in t)this.mapResult(t,e)},r.prototype=Object.create(o.prototype);var d=function(t){var e=[];for(var o in t)t.hasOwnProperty(o)&&e.push(encodeURIComponent(o)+"="+encodeURIComponent(t[o]));return e.join("&")};return r.prototype.jsonp=function(t,e,i){var r=this;return new Promise(function(s,n){function a(t){delete window[g],document.body.removeChild(y),i&&(console.log("Deprecated:  callback, use promise (Comms.prototype.jsonp)"),i(t))}for(var l in r._proxyMappings){var p=t.split(l),u=p[0];if(p.length>1){var h=(new o).url(t);t=u+r._proxyMappings[l],e.IP=h._hostname,e.PORT=h._port,p.length>0&&(e.PATH=p[1]);break}}var c=1e3*r.timeout(),f=5e3,g="jsonp_callback_"+Math.round(999999*Math.random());window[g]=function(t){c=0,a(t),s(t)};var y=document.createElement("script");y.src=t+(t.indexOf("?")>=0?"&":"?")+"jsonp="+g+"&"+d(e),document.body.appendChild(y);var m=setInterval(function(){0>=c?clearInterval(m):(c-=f,0>=c?(clearInterval(m),console.log("Request timeout:  "+y.src),a(),n(Error("Request timeout:  "+y.src))):console.log("Request pending ("+c/1e3+" sec):  "+y.src))},f)})},r.prototype.ajax=function(t,e,o){return new Promise(function(i,r){var s=e;o&&(s+="?"+d(o));var n=new XMLHttpRequest;n.onload=function(t){this.status>=200&&this.status<300?i(JSON.parse(this.response)):r(Error(this.statusText))},n.onerror=function(){r(Error(this.statusText))},n.open(t,s),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send()})},r.prototype.get=function(t,e){return this.ajax("GET",t,e)},r.prototype.post=function(t,e){return this.ajax("POST",t,e)},r.prototype.mappings=function(t){return arguments.length?(this._mappings=new i(t),this):this._mappings},r.prototype.proxyMappings=function(t){return arguments.length?(this._proxyMappings=t,this):this._proxyMappings},r.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},n.prototype=Object.create(r.prototype),n.prototype.cacheCalls=function(t){return arguments.length?(this._cacheCalls=t,this):this._cacheCalls},n.prototype.call=function(t,e){var o=this._url+(this._url.indexOf("?")>=0?"&":"?")+d(t);if(this._cacheCalls){var i=this;return new Promise(function(t,i){var r=JSON.parse(localStorage.getItem("hpcc.viz."+o));if(!r)throw Error("not cached");e&&(console.log("Deprecated:  callback, use promise (Basic.prototype.call)"),e(r)),t(r)})["catch"](function(t){return i.get(o).then(function(t){return localStorage.setItem("hpcc.viz."+o,JSON.stringify(t)),e&&(console.log("Deprecated:  callback, use promise (Basic.prototype.call)"),e(t)),t})})}return localStorage.removeItem("hpcc.viz."+o),this.get(o).then(function(t){return e&&(console.log("Deprecated:  callback, use promise (Basic.prototype.call)"),e(t)),t})},a.prototype=Object.create(r.prototype),a.prototype.url=function(t){var e=r.prototype.url.apply(this,arguments);if(arguments.length){this._port="8010"===this._port?"8002":this._port;for(var o in this._params)switch(o){case"QuerySetId":this.target(this._params[o]);break;case"Id":this.query(this._params[o])}var i,s;this._target||this._query||(i=this._pathname.split("/res/"),i.length>=2&&(s=i[1].split("/"),s.length>=3&&(this.target(s[1]),this.query(s[2])))),this._target||this._query||(i=this._pathname.split("/forms/default/"),i.length>=2&&(s=i[1].split("/"),s.length>=3&&(this.target(s[1]),this.query(s[2]))))}return e},a.prototype.target=function(t){return arguments.length?(this._target=t,this):this._target},a.prototype.query=function(t){return arguments.length?(this._query=t,this):this._query},a.prototype.constructUrl=function(){return r.prototype.getUrl.call(this,{pathname:"WsEcl/submit/query/"+this._target+"/"+this._query+"/json"})},a.prototype.call=function(t,o,i){t=t||{},t.target=t.target||this._target,t.query=t.query||this._query;var r=this,s=this.getUrl({pathname:"WsEcl/submit/query/"+t.target+"/"+t.query+"/json"});return this.jsonp(s,o).then(function(t){for(var o in t){t=t[o].Results;break}if(t.Exception)throw Error(t.Exception.reduce(function(t,e,o,i){return t.length&&(t+="\n"),t+e.Source+" "+e.Code+":  "+e.Message},""));for(o in t)t[o].Row&&(t[o]=t[o].Row.map(e));return r._mappings.mapResponse(t),i&&(console.log("Deprecated:  callback, use promise (WsECL.prototype.call)"),i(t)),t})},a.prototype.send=function(t,e){this.call({target:this._target,query:this._query},t,e)},l.prototype=Object.create(r.prototype),l.prototype.url=function(t){var e=r.prototype.url.apply(this,arguments);if(arguments.length){for(var o in this._params)switch(o){case"Wuid":this.wuid(this._params[o]);break;case"ResultName":this.resultName(this._params[o]);break;case"Sequence":this.sequence(this._params[o])}if(!this._wuid){var i=this._url.split("/res/");if(i.length>=2){var s=i[1].split("/");this.wuid(s[0])}}}return e},l.prototype.wuid=function(t){return arguments.length?(this._wuid=t,this):this._wuid},l.prototype.jobname=function(t){return arguments.length?(this._jobname=t,this):this._jobname},l.prototype.sequence=function(t){return arguments.length?(this._sequence=t,this):this._sequence},l.prototype.resultName=function(t){return arguments.length?(this._resultName=t,this):this._resultName},l.prototype.appendParam=function(t,e,o){return e?(o&&(o+="&"),o+t+"="+e):o},l.prototype.constructUrl=function(){var t=r.prototype.getUrl.call(this,{pathname:"WsWorkunits/res/"+this._wuid+"/"}),e="";return e=this.appendParam("ResultName",this._resultName,e),t+(e?"?"+e:"")},l.prototype._fetchResult=function(t,o,i){t=t||{},t._start=t._start||0,t._count=t._count||-1;var r=this.getUrl({pathname:"WsWorkunits/WUResult.json"}),s={Wuid:t.wuid,ResultName:t.resultname,SuppressXmlSchema:!0,Start:t._start,Count:t._count};this._resultNameCache[t.resultname]={};var n=this;return this.jsonp(r,s).then(function(r){for(var s in r){if(!r[s].Result)throw"No result found.";n._total=r[s].Total,r=r[s].Result;for(var a in r){r=r[a].Row.map(e);break}break}return n._resultNameCache[t.resultname]=r,i||n._mappings.mapResult(n._resultNameCache,t.resultname),o&&(console.log("Deprecated:  callback, use promise (WsWorkunits.prototype._fetchResult)"),o(n._resultNameCache[t.resultname])),n._resultNameCache[t.resultname]})},l.prototype.fetchResult=function(t,e,o){if(t.wuid)return this._fetchResult(t,e,o);if(t.jobname){var i=this;return this.WUQuery(t,function(r){return t.wuid=r[0].Wuid,i._fetchResult(t,e,o)})}},l.prototype.WUQuery=function(t,e){var o=this.getUrl({pathname:"WsWorkunits/WUQuery.json"}),i={Jobname:i.jobname,Count:1};return this._resultNameCache={},this._resultNameCacheCount=0,this.jsonp(o,i).then(function(t){if(!s("WUQueryResponse.Workunits.ECLWorkunit",t))throw"No workunit found.";return t=t.WUQueryResponse.Workunits.ECLWorkunit,e&&(console.log("Deprecated:  callback, use promise (WsWorkunits.prototype.WUQuery)"),e(t)),t})},l.prototype.fetchResultNames=function(t){var e=this.getUrl({pathname:"WsWorkunits/WUInfo.json"}),o={Wuid:this._wuid,TruncateEclTo64k:!0,IncludeExceptions:!1,IncludeGraphs:!1,IncludeSourceFiles:!1,IncludeResults:!0,IncludeResultsViewNames:!1,IncludeVariables:!1,IncludeTimers:!1,IncludeResourceURLs:!1,IncludeDebugValues:!1,IncludeApplicationValues:!1,IncludeWorkflows:!1,IncludeXmlSchemas:!1,SuppressResultSchemas:!0};this._resultNameCache={},this._resultNameCacheCount=0;var i=this;return this.jsonp(e,o).then(function(e){return s("WUInfoResponse.Workunit.Results.ECLResult",e)&&e.WUInfoResponse.Workunit.Results.ECLResult.map(function(t){i._resultNameCache[t.Name]=[],++i._resultNameCacheCount}),t&&(console.log("Deprecated:  callback, use promise (WsWorkunits.prototype.fetchResultNames)"),t(i._resultNameCache)),i._resultNameCache})},l.prototype.fetchResults=function(t,e){var o=this;return this.fetchResultNames().then(function(i){var r=[];for(var s in o._resultNameCache)r.push(o.fetchResult({wuid:o._wuid,resultname:s},null,e));return Promise.all(r).then(function(e){return t&&(console.log("Deprecated:  callback, use promise (WsWorkunits.prototype.fetchResults)"),t(o._resultNameCache)),o._resultNameCache})})},l.prototype.postFilter=function(t,e){var o={};for(var i in e)o[i]=e[i].filter(function(e,o){for(var i in t)if(void 0!==e[i]&&void 0!==t[i]&&e[i]!=t[i])return!1;return!0});return this._mappings.mapResponse(o),o},l.prototype.send=function(t,e){var o=this;this._resultNameCacheCount?e(o.postFilter(t,this._resultNameCache)):this.fetchResults(function(i){e(o.postFilter(t,i))},!0)},p.prototype=Object.create(r.prototype),p.prototype.url=function(t){var e=r.prototype.url.apply(this,arguments);if(arguments.length)for(var o in this._params)switch(o){case"WUID":this.wuid(this._params[o])}return e},p.prototype.wuid=function(t){return arguments.length?(this._wuid=t,this):this._wuid},p.prototype.constructUrl=function(){return r.prototype.getUrl.call(this,{pathname:"WsWorkunits/WUGetStats?WUID="+this._wuid})},p.prototype.send=function(t,e){var o=this.getUrl({pathname:"WsWorkunits/WUGetStats.json?WUID="+this._wuid});return this.jsonp(o,t).then(function(t){return s("WUGetStatsResponse.Statistics.WUStatisticItem",t)?(e&&(console.log("Deprecated:  callback, use promise (WsWorkunits_GetStats.prototype.send)"),e(t.WUGetStatsResponse.Statistics.WUStatisticItem)),t.WUGetStatsResponse.Statistics.WUStatisticItem):(e&&(console.log("Deprecated:  callback, use promise (WsWorkunits_GetStats.prototype.send)"),e([])),[])})},u.prototype=Object.create(r.prototype),u.prototype.fetchResults=function(t,o){var i=this.getUrl({});this._resultNameCache={},this._resultNameCacheCount=0;var r=this;return this.jsonp(i,t).then(function(t){for(var i in t){t=t[i].Results;break}if(t.Exception)throw Error(t.Exception.reduce(function(t,e,o,i){return t.length&&(t+="\n"),t+e.Source+" "+e.Code+":  "+e.Message},""));for(i in t)t[i].Row&&(r._resultNameCache[i]=t[i].Row.map(e),++r._resultNameCacheCount);return o&&(console.log("Deprecated:  callback, use promise (HIPIERoxie.prototype.fetchResults)"),o(r._resultNameCache)),r._resultNameCache})},u.prototype.fetchResult=function(t,e){var o=this;return new Promise(function(i,r){e&&(console.log("Deprecated:  callback, use promise (HIPIERoxie.prototype.fetchResult)"),e(o._resultNameCache[t])),i(o._resultNameCache[t])})},u.prototype.call=function(t,e){return this.fetchResults(t,e)},h.prototype=Object.create(l.prototype),h.prototype.hipieResults=function(t){if(!arguments.length)return this._hipieResults;this._hipieResultsLength=0,this._hipieResults={};var e=this;return t.forEach(function(t){e._hipieResultsLength++,e._hipieResults[t.id]=t}),this},h.prototype.fetchResults=function(t){var e=this;return l.prototype.fetchResultNames.call(this).then(function(o){var i=[];for(var r in e._hipieResults){var s=e._hipieResults[r];i.push(e.fetchResult(s.from))}return Promise.all(i).then(function(o){return t&&(console.log("Deprecated:  callback, use promise (HIPIEWorkunit.prototype.fetchResults)"),t(e._resultNameCache)),e._resultNameCache})})},h.prototype.fetchResult=function(t,e){return l.prototype.fetchResult.call(this,{wuid:this._wuid,resultname:t}).then(function(t){return e&&(console.log("Deprecated:  callback, use promise (HIPIEWorkunit.prototype.fetchResult)"),e(t)),t})},h.prototype.call=function(t,e){if(!t.refresh&&this._resultNameCache&&this._resultNameCacheCount){var o=this;return new Promise(function(i,r){var s={};for(var n in t)void 0!==t[n]&&void 0!==t[n+"_changed"]&&(s[n]=t[n]);var a={};for(var l in o._hipieResults){var p=o._hipieResults[l],u=!0;for(var h in s)if(p.filter.indexOf(h)<0){u=!1;break}u&&(a[p.from]=o._resultNameCache[p.from].filter(function(t){for(var e in s)if(t[e]!=s[e]&&t[e.toLowerCase()]!=s[e])return!1;return!0}))}e&&(console.log("Deprecated:  callback, use promise (HIPIEWorkunit.prototype.call)"),e(a)),i(a)})}return this.fetchResults(e)},c.prototype=Object.create(h.prototype),c.prototype.databomb=function(t){return arguments.length?(this._databomb=t.map(e),this):this._databomb},c.prototype.databombOutput=function(t){return arguments.length?(this._resultNameCacheCount++,this._resultNameCache[t]=this._databomb,this):void 0},c.prototype.fetchResults=function(t){var e=this;return new Promise(function(o,i){t&&(console.log("Deprecated:  callback, use promise (HIPIEDatabomb.prototype.fetchResults)"),t(e._resultNameCache)),o(e._resultNameCache)})},{Basic:n,ESPMappings:i,ESPUrl:o,WsECL:a,WsWorkunits:l,HIPIERoxie:u,HIPIEWorkunit:h,HIPIEDatabomb:c,createESPConnection:function(t){t=t||document.URL;var e=(new o).url(t);return e.isWsWorkunits_GetStats()?(new p).url(t):e.isWsWorkunits()?(new l).url(t):e.isWsEcl()?(new a).url(t):null}}}),function(t,e){"function"==typeof define&&define.amd?define("other/HeatMap.js",["d3","../common/CanvasWidget","simpleheat","../common/Palette"],e):t.other_HeatMap=e(t.d3,t.common_CanvasWidget,t.simpleheat,t.common_Palette)}(this,function(t,e,o,i){function r(){e.call(this)}return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype._palette=i.rainbow("default"),r.prototype._class+=" other_HeatMap",r.prototype.publish("radius",15,"number","Set point radius",null,{tags:["Basic"]}),r.prototype.publish("blur",15,"number","Set point blur",null,{tags:["Basic"]}),r.prototype.publish("max",1,"number","Set max data value",null,{tags:["Basic"]}),r.prototype.publish("gradient",{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},"object","Set gradient colors",null,{tags:["Basic"]}),r.prototype.publish("usePalette",!1,"boolean","If true, uses paletteID and colorCount to determine gradient",null,{tags:["Basic"]}),r.prototype.publish("colorCount",10,"number","Top left x-value",null,{tags:["Basic"]}),r.prototype.publish("paletteID","default","set","Palette ID",r.prototype._palette["switch"](),{tags:["Basic"]}),r.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),r.prototype.publish("topLeftX",null,"number","Top left x-value",null,{tags:["Basic"],optional:!0}),r.prototype.publish("topLeftY",null,"number","Top left y-value",null,{tags:["Basic"],optional:!0}),r.prototype.publish("bottomRightX",null,"number","Bottom right x-value",null,{tags:["Basic"],optional:!0}),r.prototype.publish("bottomRightY",null,"number","Bottom right y-value",null,{tags:["Basic"],optional:!0}),r.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments),this.resize(this._size),this._heat=o(t)},r.prototype.update=function(t,o){if(e.prototype.update.apply(this,arguments),this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this.topLeftX_exists()&&this.topLeftY_exists()&&this.bottomRightX_exists()&&this.bottomRightY_exists()?this._heat.data(this.skewedData()):this._heat.data(this.data()),this.radius()&&this._heat.radius(this.radius(),this.blur()),this.usePalette()){for(var i={},r=1;r<=this.colorCount();r++){var s=r/this.colorCount();i[s]=this._palette(r,1,this.colorCount())}this._heat.defaultGradient=i,this._heat.gradient(i)}else this.gradient()&&(this._heat.defaultGradient=this.gradient(),this._heat.gradient(this.gradient()));this._heat.draw()},r.prototype.exit=function(t,o){delete this._heat,e.prototype.exit.apply(this,arguments)},r.prototype.resize=function(t){e.prototype.resize.apply(this,arguments),void 0!==this._heat&&this._heat.resize()},r.prototype.skewedData=function(){var t=this,e=[],o=this.data(),i=this.element().node().getBoundingClientRect(),r=this.bottomRightX()-this.topLeftX(),s=this.bottomRightY()-this.topLeftY(),n=r/i.width,a=s/i.height;return o.forEach(function(o){var i=Math.abs(o[0]-t.topLeftX()),r=Math.abs(o[1]-t.topLeftY()),s=i/n,l=r/a;e.push([s,l,o[2]])}),e},r}),"function"==typeof define&&define.amd&&define("css",[],function(){return{load:function(t,e,o){o()}}}),function(t,e){"function"==typeof define&&define.amd?define("other/Html.js",["../common/HTMLWidget","css!./Html"],e):t.other_Html=e(t.common_HTMLWidget)}(this,function(t){function e(){t.call(this),this._tag="div"}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype._class+=" other_Html",e.prototype.publish("html","","string","Html to render",null,{tags:["Basic"]}),e.prototype.publish("overflowX",null,"set","CSS overflow-x",["","visible","hidden","scroll","auto","initial","inherit"],{tags:["Basic"],optional:!0}),e.prototype.publish("overflowY",null,"set","CSS overflow-y",["","visible","hidden","scroll","auto","initial","inherit"],{tags:["Basic"],optional:!0}),e.prototype.enter=function(e,o){t.prototype.enter.apply(this,arguments)},e.prototype.update=function(e,o){t.prototype.update.apply(this,arguments),o.style({"overflow-x":this.overflowX_exists()?this.overflowX():"","overflow-y":this.overflowY_exists()?this.overflowY():""});var i=o.selectAll(".htmlWrapper").data(this.data().length>0?this.data():[this.html()]);i.enter().append("div").attr("class","htmlWrapper"),i.html(function(t){return t}),i.exit().remove()},e}),function(t,e){"function"==typeof define&&define.amd?define("other/Image.js",["../common/HTMLWidget"],e):t.other_Image=e(t.common_HTMLWidget)}(this,function(t){function e(){t.call(this),this._tag="img",this._prevSource=void 0}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype._class+=" other_Image",e.prototype.publish("source",null,"string","Image Source",null,{tags:["Basic"]}),e.prototype.publish("sizing","actual","set","Controls sizing mode",["actual","fit","custom"],{tags:["Basic"]}),e.prototype.publish("customWidth","50%","string","Applies this width to IMG element if 'sizing' is set to 'custom'",null,{tags:["Basic"]}),e.prototype.publish("customHeight","20%","string","Applies this height to IMG element if 'sizing' is set to 'custom'",null,{tags:["Basic"]}),e.prototype.publish("lockAspectRatio",!0,"boolean","Locks the aspect ratio when scaling/stretching",null,{tags:["Basic"]}),e.prototype.enter=function(e,o){t.prototype.enter.apply(this,arguments),o.attr("src",this.source()),this._prevSource=this.source(),this.initSource(o)},e.prototype.update=function(e,o){t.prototype.update.apply(this,arguments),this.changedSource()&&this.initSource(o),"custom"===this.sizing()?o.style({width:this.customWidth(),height:this.customHeight()}):"actual"===this.sizing()?o.style({width:"auto",height:"auto"}):"fit"===this.sizing()&&o.style({width:"100%",height:"100%"}),this.lockAspectRatio()&&this.applyAspectRatio(o);var i=o.node().getBoundingClientRect();this._projectScaleY=i.height/this._sourceHeight,this._projectScaleX=i.width/this._sourceWidth},e.prototype.changedSource=function(){return this._prevSource!==this.source()},e.prototype.exit=function(e,o){t.prototype.exit.apply(this,arguments)},e.prototype.initSource=function(t){t.attr("src",this.source()),t.style({width:"auto",height:"auto"}),this._prevSource=this.source(),this._sourceBBox=t.node().getBoundingClientRect(),this._sourceWidth=this._sourceBBox.width,this._sourceHeight=this._sourceBBox.height,this._ratio=this._sourceBBox.width/this._sourceBBox.height},e.prototype.projection=function(t,e){return{x:t*this._projectScaleX,y:e*this._projectScaleY}},e.prototype.applyAspectRatio=function(t){var e=t.node().getBoundingClientRect();e.width<e.height?t.style({height:1/this._ratio*e.width+"px"}):t.style({width:this._ratio*e.height+"px"})},e}),function(t,e){"function"==typeof define&&define.amd?define("other/Paginator.js",["d3","../common/HTMLWidget","css!./Paginator"],e):t.other_Paginator=e(t.d3,t.common_HTMLWidget)}(this,function(t,e){function o(){e.call(this),this._tag="div",this._tNumPages=1,this._numList=[]}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" other_Paginator",o.prototype.publish("itemsPerPage",2,"number","Pagination items per page",null,{tags:["Private"]}),o.prototype.publish("numItems",10,"number","Pagination total number of items",null,{tags:["Private"]}),o.prototype.publish("pageNumber",1,"number","Pagination set or get the page number",null,{tags:["Private"]}),o.prototype.publish("adjacentPages",2,"number","Number of page indexes either side of current one",null,{tags:["Private"]}),o.prototype.publish("bottom",20,"number","Pagination bottom offset",null,{tags:["Private"]}),o.prototype.publish("right",20,"number","Pagination right offset",null,{tags:["Private"]}),o.prototype.postUpdate=function(t,e){},o.prototype.enter=function(t,o){e.prototype.enter.apply(this,arguments);var i=this;this.paginator=o.append("ul").attr("class","paginator pagination pagination-sm"),this.side=o.append("div").attr("class","paginator pagination side"),this.side.append("span").classed("side",!0).text("Page "),this.side.append("input").attr("type","number").attr("class","currentPageNumber").property("value",1).attr("min",1).on("change",function(){i.pageNumber(this.value),i._onSelect(this.value)}),this.side.append("span").classed("side total",!0).text(" of 1")},o.prototype.update=function(e,o){var i=this;if(o.style("bottom",this.bottom()+"px").style("right",this.right()+"px"),this._tNumPages=Math.ceil(this.numItems()/this.itemsPerPage())||1,this.pageNumber()>this._tNumPages&&this.pageNumber(1),this._numList=[],this.numItems()){this._numList.push("first");for(var r=-this.adjacentPages();r<=this.adjacentPages();r++)this.pageNumber()+r>0&&this.pageNumber()+r<=this._tNumPages&&this._numList.push(this.pageNumber()+r);this._numList.push("last")}this.side.select(".total").text(" of "+this._tNumPages),this.side.select(".currentPageNumber").property("value",this.pageNumber()),this.side.select(".currentPageNumber").attr("max",this._tNumPages);var s=this.paginator.selectAll("li").data(this._numList,function(t){return t});s.enter().append(function(t){var e=document.createElement("li");if(t!==i.pageNumber()){var o=document.createElement("a"),r=document.createTextNode(t);return o.appendChild(r),o.href="#",e.appendChild(o),e}var s=document.createElement("span");return s.innerHTML=t,e.appendChild(s),e}).on("click",function(e,o){switch(t.event.preventDefault(),i.side.select(".currentPageNumber").property("value",i.pageNumber()),e){case"first":1!==i.pageNumber()&&(i.pageNumber(1),i._onSelect(1,"previous"));break;case"last":i.pageNumber()!==i._tNumPages&&(i.pageNumber(i._tNumPages),i._onSelect(i._tNumPages,"previous"));break;default:i.pageNumber(e),i._onSelect(e)}}),s.classed("active",function(t,e){return t===i.pageNumber()}).select("a").text(function(t){return t}),s.exit().remove(),s.order(),0===this.numItems()&&t.select(e).remove()},o.prototype.exit=function(t,o){e.prototype.exit.apply(this,arguments)},o}),function(t,e){"function"==typeof define&&define.amd?define("other/Table.js",["d3","../common/HTMLWidget","./Paginator","../common/Utility","../common/Widget","css!./Table"],e):t.other_Table=e(t.d3,t.common_HTMLWidget,t.other_Paginator,t.common_Utility,t.common_Widget)}(this,function(t,e,o,i,r){function s(){e.call(this),this._tag="div",this.columns([]),this._paginator=new o,this._selectionBag=new i.Selection,this._selectionPrevClick=null,this._paginatorTableSpacing=4}s.prototype=Object.create(e.prototype),s.prototype.constructor=s,s.prototype._class+=" other_Table",s.prototype.publish("renderHtmlDataCells",!1,"boolean","enable or disable HTML within cells",null,{tags:["Private"]}),s.prototype.publish("pagination",!1,"boolean","Enable or disable pagination",null,{tags:["Private"]}),s.prototype.publish("paginationLimit",null,"number","Maximum number of rows allowed before pagination defaults to on",null,{tags:["Private"]}),s.prototype.publishProxy("itemsPerPage","_paginator"),s.prototype.publishProxy("pageNumber","_paginator","pageNumber",1),s.prototype.publishProxy("adjacentPages","_paginator"),s.prototype.publish("topN",null,"number","Total number or rows of data to be displayed in the table",null,{tags:["Private"]}),s.prototype.publish("pivot",!1,"boolean","Pivot Table"),s.prototype.publish("showHeader",!0,"boolean","Show or hide the table header",null,{tags:["Private"]}),s.prototype.publish("fixedHeader",!0,"boolean","Enable or disable fixed table header",null,{tags:["Private"]}),s.prototype.publish("fixedColumn",!1,"boolean","Enable or disable fixed first column",null,{tags:["Private"]}),s.prototype.publish("multiSelect",!1,"boolean","Multiple Selection",null,{tags:["Basic"]}),s.prototype.publish("fixedSize",!1,"boolean","Fix Size to Min Width/Height"),s.prototype.publish("theadFontSize",null,"string","Table head font size",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tbodyFontSize",null,"string","Table body font size",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tfootFontSize",null,"string","Table body font size",null,{tags:["Basic"],optional:!0}),s.prototype.publish("theadFontColor",null,"html-color","Table head font color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tbodyFontColor",null,"html-color","Table body font color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tfootFontColor",null,"html-color","Table body font color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("theadFontFamily",null,"string","Table head font family",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tbodyFontFamily",null,"string","Table body font family",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tfootFontFamily",null,"string","Table body font family",null,{tags:["Basic"],optional:!0}),s.prototype.publish("theadCellBorderColor",null,"html-color","Table head cell border color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tfootCellBorderColor",null,"html-color","Table head cell border color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("theadRowBackgroundColor",null,"html-color","Table head row color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tfootRowBackgroundColor",null,"html-color","Table head row color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tbodyCellBorderColor",null,"html-color","Table body cell border color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tbodyRowBackgroundColor",null,"html-color","Table body row color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tbodyFirstColFontColor",null,"html-color","Table body first column font color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tbodyFirstColBackgroundColor",null,"html-color","Table body first column background color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tbodyHoverRowFontColor",null,"html-color","Table body hover row font color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tbodyHoverRowBackgroundColor",null,"html-color","Table body hover row background color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tbodySelectedRowFontColor",null,"html-color","Table body selected row color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tbodySelectedRowBackgroundColor",null,"html-color","Table body selected row color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("tableZebraColor",null,"html-color","Table zebra row color",null,{tags:["Basic"],optional:!0}),s.prototype.publish("totalledColumns",[],"array","Array of indices of the columns to be totalled",null,{tags:["Basic"],optional:!0,disable:function(t){return t.pivot()}}),s.prototype.publish("totalledLabel",null,"string","Adds a label to the first column of the 'Totalled' row",null,{tags:["Basic"],optional:!0,disable:function(t){return t.pivot()}}),s.prototype.publish("stringAlign","left","set","Array of alignment positions for strings",["left","right","center"],{
tags:["Basic"],optional:!0}),s.prototype.publish("numberAlign","right","set","Array of alignment positions for numbers",["left","right","center"],{tags:["Basic"],optional:!0}),s.prototype.publish("minWidgetWidth",null,"number","Minimum width of a child widget",null,{tags:["Basic"],optional:!0}),s.prototype.publish("minWidgetHeight",null,"number","Minimum height of a child widget",null,{tags:["Basic"],optional:!0}),s.prototype.publish("sortByFieldIndex",null,"number","Index for the field/column to sort the data",null,{tags:["Basic"],optional:!0}),s.prototype.publish("descending",!1,"boolean","Direction for sorting the data: ascending (true) or descending (false)",null,{tags:["Basic"],optional:!0}),s.prototype.size=function(t){var o=e.prototype.size.apply(this,arguments);if(arguments.length&&this.tableDiv){var i=this.showHeader()&&this.fixedHeader()?this.thead.property("offsetHeight"):0;this.tableDiv.style("width",this._size.width+"px").style("height",this._size.height-i+"px"),this._element.style("width",this._size.width+"px").style("height",this._size.height+"px")}return o};var n=s.prototype.columns;s.prototype.columns=function(t){var e=n.apply(this,arguments);return!arguments.length&&this.pivot()?this._db.column(0):e};var a=s.prototype.data;s.prototype.data=function(t){var e=a.apply(this,arguments);return!arguments.length&&this.pivot()?this._db.columns().filter(function(t,e){return e>0}):e};var l={transform:function(t){return t}};return s.prototype.field=function(t,e){return this.pivot()?0===e?l:this.fields()[t+1]:-1===t?l:this.fields()[e]},s.prototype.enter=function(t,o){e.prototype.enter.apply(this,arguments),this._parentElement.style("overflow","hidden"),this.tableDiv=o.append("div").attr("class","tableDiv"),this.table=this.tableDiv.append("table"),this.fixedHead=o.append("div").classed("header-wrapper",!0),this.fixedHeadTable=this.fixedHead.append("table"),this.fixedThead=this.fixedHeadTable.append("thead").append("tr"),this.unfixedThead=this.table.append("thead").append("tr"),this.tbody=this.table.append("tbody"),this.tfoot=this.table.append("tfoot").append("tr"),this.fixedCol=o.append("div").classed("rows-wrapper",!0),this.fixedColTable=this.fixedCol.append("table"),this.fixedColHead=this.fixedColTable.append("thead"),this.fixedColHeadRow=this.fixedColHead.append("tr"),this.fixedColBody=this.fixedColTable.append("tbody"),this.fixedColFoot=this.fixedColTable.append("tfoot"),this.fixedColFootRow=this.fixedColFoot.append("tr"),this.tableDiv.style("overflow","auto"),this._childWidgets=[]},s.prototype.update=function(o,s){function n(){var t=O.width;k=l.tbody.property("offsetWidth")+1,N=t>k?k:t,N=N}function a(){R=l.tbody.property("offsetHeight")+S,R=R}e.prototype.update.apply(this,arguments);var l=this;this.element().selectAll("table,tbody,th,td").style("width",null),!this.sortByFieldIndex_exists()||this._prevSortByFieldIndex===this.sortByFieldIndex()&&this._prevDescending===this.descending()||(i.multiSort(this.data(),[{idx:this.sortByFieldIndex(),reverse:this.descending()}]),this._prevSortByFieldIndex=this.sortByFieldIndex(),this._prevDescending=this.descending()),this._childWidgets.forEach(function(t,e){t.target(null)}),this._childWidgets=[],this.fixedHeader()?this.thead=this.fixedThead:this.thead=this.unfixedThead,this.fixedHead.style("display",this.fixedHeader()?"table-row":"none"),this.unfixedThead.style("display",this.fixedHeader()?"none":"table-row");var p=this.thead.selectAll("th").data(this.showHeader()?this.columns():[],function(t){return t});if(p.enter().append("th").each(function(e){var o=t.select(this);o.append("span").attr("class","thText"),o.append("span").attr("class","thIcon")}).on("click",function(t,e){l.headerClick(t,e)}),p.style("background-color",this.theadRowBackgroundColor()).style("border-color",this.theadCellBorderColor()).style("color",this.theadFontColor()).style("font-size",this.theadFontSize()),p.select(".thText").style("font-family",this.theadFontFamily()).text(function(t,e){return l.field(-1,e).transform(t)}),p.select(".thIcon").text(function(t,e){return l.descending()?l.sortByFieldIndex()===e?"":"":l.sortByFieldIndex()===e?"":""}),p.exit().remove(),p.order(),this.paginationLimit()&&this.pagination(this.data().length>=parseInt(this.paginationLimit())?!0:!1),this.pagination()){null===this._paginator.target()&&this._paginator.target(s.node());var u=this._calcRowsPerPage(p);this.itemsPerPage(u),this._paginator.numItems(this.data().length),this._tNumPages=Math.ceil(this._paginator.numItems()/this.itemsPerPage())||1,(this.pageNumber()>this._tNumPages||this.pageNumber()<=0)&&this.pageNumber(1),this._paginator._onSelect=function(t,e){l.pageNumber(t),l.render()}}else this._paginator.numItems(0);var h=this.pageNumber()-1,c=this.itemsPerPage(),d=h*c,f=parseInt(h*c)+parseInt(c),g=null;g=this.topN()?this.data().slice(0,this.topN()):this.pagination()?this.data().slice(d,f):this.data();var y=[this.totalledLabel()?this.totalledLabel():null];if(0!==l.totalledColumns().length){for(var m=0;m<l.totalledColumns().length;m++)l.totalledColumns()[m]=+l.totalledColumns()[m];for(var _=1;_<l.columns().length;_++){var b=0;if(-1!==l.totalledColumns().indexOf(_)){for(var v=0;v<g.length;v++)b+=g[v][_];y.push(b)}else y.push("")}var w=this.tfoot.selectAll("td").data(y);w.enter().append("td"),w[this.renderHtmlDataCells()?"html":"text"](function(t,e){return l.fields()[e].transform(t)}),w.exit().remove(),w.style("background-color",this.tfootRowBackgroundColor()).style("border-color",this.tfootCellBorderColor()).style("color",this.tfootFontColor()).style("font-size",this.tfootFontSize())}var x=this.tbody.selectAll("tr").data(g.map(function(t,e){return{rowIdx:e,row:t}}));x.enter().append("tr").on("click.selectionBag",function(t){var e=t.row,o=t.rowIdx;l.selectionBagClick(e,o),l.applyRowStyles(l.getBodyRow(o)),l.applyFirstColRowStyles(l.getFixedRow(o)),l.click(l.rowToObj(e),o,l._selectionBag.isSelected(l._createSelectionObject(e)))}).on("mouseover",function(t){var e=t.rowIdx,o=l.getFixedRow(e);o.empty()||o.classed("hover",!0);var i=l.getBodyRow(e);i.classed("hover",!0),l.applyStyleToRows(i),l.applyFirstColRowStyles(o)}).on("mouseout",function(t){var e=t.rowIdx,o=l.getFixedRow(e);o.classed("hover",!1);var i=l.getBodyRow(e);i.classed("hover",!1),l.applyStyleToRows(i),l.applyFirstColRowStyles(o)}),x.classed("selected",function(t){var e=t.row;return l._selectionBag.isSelected(l._createSelectionObject(e))}).classed("trId"+l._id,!0),x.exit().remove();var C=x.selectAll("td").data(function(t){return t.row.filter(function(t,e){return e<l.columns().length}).map(function(e,o){return{rowIdx:t.rowIdx,colIdx:o,cell:e}})});C.enter().append("td"),C[this.renderHtmlDataCells()?"html":"text"](function(t,e){return t.cell instanceof r?void 0:l.field(t.rowIdx,t.colIdx).transform(t.cell)}),C.exit().remove(),x.each(function(e,o){var i=t.select(this);i.selectAll("td").each(function(e,i){var s=l.getColumnAlignment(e.rowIdx,e.colIdx,e.cell),n=t.select(this);n.style({height:null,"text-align":s}).classed("tr-"+o+"-td-"+i,!0),e.cell instanceof r&&(l.pagination()&&console.log("Warning: displaying another widget in the table may cause problems with pagination"),0===e.cell.size().height&&(e.cell.height(l.minWidgetHeight()),e.cell.width(this.offsetWidth>l.minWidgetWidth()?this.offsetWidth:l.minWidgetWidth())),e.cell.target(null),e.cell.target(this),e.cell._parentWidget=l,e.cell._class.indexOf("childWidget")<0&&(e.cell._class="childWidget "+e.cell._class),e.cell.render(),l._childWidgets.push(e.cell))}),l.applyStyleToRows(i)});var S=parseInt(this.thead.node().offsetHeight);this.pagination()&&this._childWidgets.length?(this.tableDiv.style("overflow-y","auto"),this.table.style("margin-bottom","50px")):(this.tableDiv.style("overflow-y",null),this.table.style("margin-bottom",null)),this.size(this._size);var W=0,T=this.fixedColHeadRow.selectAll("th").data(this.fixedColumn()&&this.showHeader()?[this.columns()[0]]:[]);T.enter().append("th").each(function(e){var o=t.select(this);o.append("span").attr("class","thText"),o.append("span").attr("class","thIcon")}).on("click",function(t,e){l.headerClick(t,e)}),T.style("background-color",this.theadRowBackgroundColor()).style("border-color",this.theadCellBorderColor()).style("color",this.theadFontColor()).style("font-size",this.theadFontSize()),T.select(".thText").style("font-family",this.theadFontFamily()).text(function(t){return t}),T.select(".thIcon").text(function(t,e){return l.descending()?l.sortByFieldIndex()===e?"":"":l.sortByFieldIndex()===e?"":""}),T.exit().remove();var I=this.fixedColBody.selectAll("tr").data(this.fixedColumn()?g:[]);I.enter().append("tr").attr("class",function(){return"trId"+l._id}),I.on("click",function(e,o){t.select(x[0][o]).on("click.selectionBag")(x.data()[o],o)}).on("mouseover",function(e,o){t.select(x[0][o]).on("mouseover")(x.data()[o],o)}).on("mouseout",function(e,o){t.select(x[0][o]).on("mouseout")(x.data()[o],o)}).classed("selected",function(t){return l._selectionBag.isSelected(l._createSelectionObject(t))}),I.exit().remove();var P=I.selectAll("td").data(function(t,e){return[t[0]]});P.enter().append("td"),P[this.renderHtmlDataCells()?"html":"text"](function(t){return"string"==typeof t?t.trim():"number"==typeof t?t:""}),P.exit().remove();var B=this.fixedColFootRow.selectAll("td").data(this.fixedColumn()&&this.totalledLabel()?[this.totalledLabel()]:[]);if(B.enter().append("td"),B[this.renderHtmlDataCells()?"html":"text"](function(t){return"string"==typeof t?t.trim():"number"==typeof t?t:""}),B.exit().remove(),this.fixedColumn()&&!this.fixedSize()&&P.length&&(W=this.showHeader()?P.property("offsetWidth")>T.property("offsetWidth")?P.property("offsetWidth"):T.property("offsetWidth"):P.property("offsetWidth"),this.fixedCol.style("position","absolute").style("margin-top",-this.tableDiv.property("scrollTop")+S+"px"),P.style("width",W+"px"),this.fixedColHead.style("position","absolute").style("margin-top",(this.fixedHeader()?this.tableDiv.property("scrollTop"):0)-S+"px"),T.style("width",W+"px"),x.each(function(e,o){var i=t.select(this).select("td").property("offsetHeight");t.select(P[o][0]).style("height",i+"px")})),this.table.style("margin-left",-W+"px"),this.tableDiv.style("margin-left",W+"px").style("width",this.width()-W+"px"),this._paginator.render(),this._paginator.right((this.hasVScroll(this.tableDiv)?this.getScrollbarWidth():0)+this._paginatorTableSpacing).bottom((this.hasHScroll(this.tableDiv)?this.getScrollbarWidth():0)+this._paginatorTableSpacing).render(),x.empty()||this.setColumnWidths(x),this.fixedSize()){var R,N,k,O=t.select(".tableDiv > table").node().getBoundingClientRect();0!==O.width&&0!==O.height?(n(),a()):(O.height-S<=l.tableDiv.property("offsetHeight")?a():l.fixedHeader()?(R=l.property("offsetHeight"),R+="px"):R="100%",O.width-W<l.tableDiv.property("offsetWidth")?n():l.fixedColumn()?(N=l.property("offsetWidth")-W,N+="px"):N="100%"),s.classed("childWidget")&&(l._parentElement.style("width",N+"px").style("height",R+"px"),l.tableDiv.style("overflow","hidden")),l.size({width:N,height:R})}this.setOnScrollEvents(this.tableDiv.node(),S)},s.prototype.exit=function(t,o){this._paginator.target(null),e.prototype.exit.apply(this,arguments)},s.prototype.setColumnWidths=function(e){var o=this,i=e.filter(function(t,e){return 0===e}),r=[];i.each(function(e){r=t.selectAll(this.childNodes)});var s=this.fixedHeader()?this.thead.property("offsetHeight"):0,n=1,a={};r.each(function(t,e){a[e]=this.offsetWidth});var l=this.thead.selectAll("th");l.each(function(t,e){var o=this.offsetWidth,i=r.empty()?0:a[e],s=o>=i?o:i;this.style.width=s+"px",!r.empty()&&r[0][e]&&(r[0][e].style.width=s+"px"),n+=s}),this.thead.style("position",this.fixedHeader()?"absolute":"relative").style("width",n+"px").style("margin-top","0px"),this.table.style("width",n+"px"),this.tableDiv.style("margin-top",(o.fixedHeader()?s:0)+"px"),this.tbody.style("width",n+"px")},s.prototype.getBodyRow=function(t){return this.table.selectAll("tbody tr.trId"+this._id).filter(function(e,o){return o===t})},s.prototype.getFixedRow=function(t){return this._element.selectAll(".rows-wrapper tbody tr").filter(function(e,o){return o===t})},s.prototype.setOnScrollEvents=function(t,e){var o=this;t.onscroll=function(t){var i=t.target.scrollTop,r=t.target.scrollLeft;o.fixedHeader()&&o.thead.style("margin-left",-r+"px"),o.fixedColumn()&&(o.fixedCol.style("margin-top",-i+e+"px"),o.fixedHeader()&&o.fixedColHead.style("margin-top",i-e+"px"))}},s.prototype._generateTempRow=function(){var t=this.tbody.append("tr");return t.append("td").text("QQQ"),t},s.prototype._createSelectionObject=function(e){var o=this;return{_id:e,element:function(){return o.tbody?o.tbody.selectAll("tr").filter(function(t){return t===e}):t.select()}}},s.prototype._calcRowsPerPage=function(t){0===this._paginator.numItems()&&(this._paginator.numItems(1),this.itemsPerPage(1)),this._paginator.render();var e=this.thead.selectAll("th").node()?this.thead.selectAll("th").node().clientHeight:0,o=this.tfoot.selectAll("td").node()?this.tfoot.selectAll("td").node().clientHeight:0,i=this._generateTempRow(),r=i.node().clientHeight;i.remove();var s=this.calcHeight(this._paginator.element()),n=Math.floor((this.height()-e-o-s-(this.table.style("width")>=this.table.style("width")?this.getScrollbarWidth():0)-2*this._paginatorTableSpacing)/r)||1;return n},s.prototype.sort=function(t){return this.sortByFieldIndex()!==t?this.descending(!1):this.descending(!this.descending()),this.sortByFieldIndex(t),this},s.prototype.selection=function(t){return arguments.length?(this._selectionBag.set(t.map(function(t){return this._createSelectionObject(t)},this)),this):this._selectionBag.get().map(function(t){return t._id})},s.prototype.selectionBagClick=function(e,o){if(this.multiSelect()&&t.event.shiftKey&&this._selectionPrevClick){var i=!1,r=[],s=this.data().filter(function(t,o){var s=!1;return(t===e||t===this._selectionPrevClick)&&(i&&(s=!0),i=!i,r.push(o)),i||s},this);this.selection(s)}else if(this.multiSelect())this._selectionBag.click(this._createSelectionObject(e),t.event),this._selectionPrevClick=e;else{var n=this._createSelectionObject(e);this._selectionBag.click(n,{ctrlKey:this._selectionBag.isSelected(n)}),this._selectionPrevClick=e}this.render()},s.prototype.applyHoverRowStyles=function(t){var e=this;t.style("color",e.tbodyHoverRowFontColor()).style("background-color",e.tbodyHoverRowBackgroundColor())},s.prototype.applySelectedRowStyles=function(t){var e=this;t.style("color",e.tbodySelectedRowFontColor()).style("background-color",e.tbodySelectedRowBackgroundColor())},s.prototype.applyRowStyles=function(t,e){t.style("color",e?this.tbodyFirstColFontColor():this.tbodyFontColor()).style("background-color",e?this.tbodyFirstColBackgroundColor():this.tableZebraColor_exists()&&this.data().indexOf(t.datum())%2?this.tbodyRowBackgroundColor():this.tableZebraColor())},s.prototype.applyFirstColRowStyles=function(t){this.applyStyleToRows(t,!0)},s.prototype.applyStyleToRows=function(e,o){o="undefined"!=typeof o?o:!1;var i=this;e.each(function(){var e=t.select(this);e.classed("hover")?i.applyHoverRowStyles(e):e.classed("selected")?i.applySelectedRowStyles(e):i.applyRowStyles(e,o)})},s.prototype.getColumnAlignment=function(t,e,o){var i=this.field(t,e);switch(i.__prop_type){case"string":return this.stringAlign();case"number":return this.numberAlign();case"":case void 0:switch(typeof o){case"string":return this.stringAlign();case"number":return this.numberAlign()}}return null},s.prototype.click=function(t,e,o){function i(t,e){return e instanceof r?"Widget with class: "+e.classID():e}console.log("Click:  "+JSON.stringify(t,i)+", "+e+","+o)},s.prototype.headerClick=function(t,e){this.sort(e).render()},s}),function(t,e){"function"==typeof define&&define.amd?define("other/Legend.js",["d3","./Table","../common/Palette","css!./Legend"],e):t.other_Legend=e(t.d3,t.other_Table,t.common_Palette)}(this,function(t,e,o){function i(){e.call(this),this._tag="div",this.showHeader(!1)}function r(t){return'<div class="colorBlock" style="background-color:'+t+';"></div>'}function s(t){for(var e=t.toString().split(".")[0],o=t.toString().split(".")[1];/(\d+)(\d{3})/.test(e.toString());)e=e.toString().replace(/(\d+)(\d{3})/,"$1,$2");return"undefined"!=typeof o?e+"."+o:e}return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype._class+=" other_Legend",i.prototype.publish("dataFamily","ND","set","Type of data",["1D","2D","ND","any"],{tags:["Private"]}),i.prototype.publish("orientation","vertical","set","Orientation of Legend rows",["vertical","horizontal"],{tags:["Private"]}),i.prototype.targetWidget=function(t){if(!arguments.length)return this._targetWidget;this._targetWidget=t,this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor);var e=this;return this._targetWidgetMonitor=this._targetWidget.monitor(function(t,o,i,r){switch(t){case"chart":case"columns":case"data":case"paletteID":e.lazyRender()}}),this},i.prototype.getWidget=function(){if(this._targetWidget)switch(this._targetWidget.classID()){case"chart_MultiChart":return this._targetWidget.chart()}return this._targetWidget},i.prototype.getPalette=function(){var t=this.getWidget();if(t&&t._palette)switch(t._palette.type()){case"ordinal":return o.ordinal(t._palette.id());case"rainbow":return o.rainbow(t._palette.id())}return o.ordinal("default")},i.prototype.enter=function(t,o){e.prototype.enter.apply(this,arguments),this.renderHtmlDataCells(!0),this.fixedHeader(!1),this.fixedSize(!0),o.classed("other_Legend",!0)},i.prototype.update=function(t,o){var i=["Key","Label"],n=[];if(this._targetWidget){var a=this.getPalette();switch(a.type()){case"ordinal":switch(this.dataFamily()){case"2D":n=this._targetWidget.data().map(function(t){return[r(a(t[0])),t[0]]},this);break;case"ND":var l=this._targetWidget.columns();n=l.filter(function(t,e){return e>0}).map(function(t){return[r(a(t)),t]},this)}break;case"rainbow":for(var p=a.colors().reverse(),u=p.length,h=this._targetWidget._dataMinWeight,c=this._targetWidget._dataMaxWeight,d=0;u>d;d++){var f,g,y=parseInt((c-h)/u);0===d?(g=s(h+y*(d+1)),n.push([r(p[d]),"0 - "+g])):d+1===u?(f=s(h+y*d+1),n.push([r(p[d]),f+"+"])):(f=s(h+y*d+1),g=s(h+y*(d+1)),n.push([r(p[d]),f+" - "+g]))}}}this.columns(i),this.data(n),e.prototype.update.apply(this,arguments),o.classed("horiz-legend","horizontal"===this.orientation());var m=o.select(".tableDiv > table"),_=m.node().getBoundingClientRect(),b=this._parentElement.node().getBoundingClientRect();o.select(".tableDiv").style({overflow:"visible"});var v=b.height/2-_.height/2,w=b.width/2-_.width/2;m.style({position:"absolute",top:v+"px",left:w+"px"});var x=this.pageNumber()-1,C=this.itemsPerPage(),S=x*C,W=parseInt(x*C)+parseInt(C),T=null;T=this.pagination()?this.data().slice(S,W):this.data();var I=this.tbody.selectAll("tr").data(T),P=this;I.on("click",function(t,e){P.onClick(t,e)}).on("mouseover",function(t,e){P.onMouseOver(t,e)})},i.prototype.exit=function(t,o){this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor),e.prototype.exit.apply(this,arguments)},i.prototype.onClick=function(t,e){console.log("Legend onClick method"),console.log("rowData: "+t),console.log("rowIdx: "+e)},i.prototype.onMouseOver=function(t,e){console.log("Legend onMouseOver method"),console.log("rowData: "+t),console.log("rowIdx: "+e)},i}),function(t,e){"function"==typeof define&&define.amd?define("other/MorphText.js",["../common/SVGWidget","css!./MorphText"],e):t.other_MorphText=e(t.common_SVGWidget)}(this,function(t){function e(){t.call(this)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype._class+=" other_MorphText",e.prototype.publish("anchor","middle","set","Sets anchor point",["middle"],{tags:["Basic"]}),e.prototype.publish("fontSize",14,"number","Sets fontsize",null,{tags:["Basic"]}),e.prototype.publish("reverse",!1,"boolean","Reverse Animation",null,{tags:["Basic"]}),e.prototype.publish("text","","string","Sets text/data of widget",null,{tags:["Basic"]}),e.prototype._origText=e.prototype.text,e.prototype.text=function(t){var o=e.prototype._origText.apply(this,arguments);if(arguments.length){var i={},r=t.split("");this.data(r.map(function(t){var e="_"+t;return void 0===i[e]&&(i[e]=0),i[e]++,{text:t,id:t.charCodeAt(0)+1024*i[e]}}))}return o},e.prototype.enter=function(t,e){if(!this.fontSize()){var o=window.getComputedStyle(t,null);this.fontSize(parseInt(o.fontSize))}this._fontWidth=32*this.fontSize()/48,this._textElement=e.append("g")},e.prototype.dateTime=function(){var t=new Date,e=1===t.getSeconds().toString().length?"0"+t.getSeconds():t.getSeconds(),o=1===t.getMinutes().toString().length?"0"+t.getMinutes():t.getMinutes(),i=1===t.getHours().toString().length?"0"+t.getHours():t.getHours(),r=t.getHours()>=12?"pm":"am",s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return n[t.getDay()]+" "+s[t.getMonth()]+" "+t.getDate()+" "+t.getFullYear()+" "+i+":"+o+":"+e+r},e.prototype.update=function(t,e){var o=this,i=this._textElement.selectAll("text").data(this.data(),function(t){return t.id});i.attr("class","update"),this.transition.apply(i).attr("x",function(t,e){return(-o.data().length/2+e)*o._fontWidth+o._fontWidth/2});var r=i.enter().append("text").attr("class","enter").attr("font-size",this.fontSize()).attr("dy",".35em").attr("y",(this.reverse()?1:-1)*this._fontWidth*2).attr("x",function(t,e){return(-o.data().length/2+e)*o._fontWidth+o._fontWidth/2}).style("fill-opacity",1e-6).style("text-anchor",this.anchor()).text(function(t){return t.text});this.transition.apply(r).attr("y",0).style("fill-opacity",1),i.exit().attr("class","exit"),this.transition.apply(i.exit()).attr("y",(this.reverse()?-1:1)*this._fontWidth*2).style("fill-opacity",1e-6).remove()},e}),function(t,e){"function"==typeof define&&define.amd?define("other/Persist",["../common/Utility"],e):t.other_Persist=e(t.common_Utility)}(this,function(t){function e(t){var e=[];return t.publishedProperties().forEach(function(o){var i=t,r=o;if(r.type){for(;"proxy"===r.type;)i=i[r.proxy],r=i.publishedProperty(r.method);r.id!==t.publishedProperty(o.id).id&&(r=JSON.parse(JSON.stringify(r)),r.id=t.publishedProperty(o.id).id),e.push(r)}},this),e}function o(t,i){if(t){i(t);for(var r=e(t),s=0;s<r.length;++s){var n=r[s];switch(n.type){case"widget":o(t[n.id](),i);break;case"widgetArray":case"propertyArray":var a=t[n.id]();a&&a.forEach(function(t){o(t,i)})}}}}function i(t,e){t&&t.forEach(function(t){o(t,e)})}function r(t,o,i){for(var r=e(t),s=0;s<r.length;++s){var n=r[s];"function"==typeof o&&o(t,n)||i(t,n)}}function s(t,e,i){o(t,function(t){r(t,e,i)})}return{discover:e,widgetWalker:o,widgetArrayWalker:i,propertyWalker:r,widgetPropertyWalker:s,serializeTheme:function(t,e){return JSON.stringify(this.serializeThemeToObject(t,e))},serializeThemeToObject:function(t,e){function o(t,e){var o=!1;for(var i in e)if(-1!==t.indexOf(e[i])){o=!0;break}return o}e=e||["surface","Color","Font","palette"];var i={};return s(t,null,function(t,r){if((t[r.id+"_modified"]()||t.publishedProperty(r.id).origDefaultValue!==t.publishedProperty(r.id).defaultValue)&&o(r.id,e)){var s=t._class.trim().split(" ");for(var n in s){if(void 0===i[s[n]]&&(i[s[n]]={}),void 0===i[s[n]][r.id]){i[s[n]][r.id]=t[r.id]();break}if(i[s[n]][r.id]===t[r.id]())break}}}),i},removeTheme:function(t,e){s(t,null,function(t,e){t.publishedProperty(e.id).defaultValue=t.publishedProperty(e.id).origDefaultValue}),"function"==typeof e&&e.call(this)},applyTheme:function(t,e,o){var i=this;s(t,null,function(t,o){switch(o.type){case"widget":return i.applyTheme(t[o.id](),e),!0;case"widgetArray":var r=t[o.id]();return r.forEach(function(t){i.applyTheme(t,e)},this),!0;default:t.applyTheme(e)}}),"function"==typeof o&&o.call(this)},serializeToObject:function(t,e,o){var i={__class:t.classID()};0!==t._id.indexOf(t._idSeed)&&(i.__id=t._id),t.version&&(i.__version=t.version()),i.__properties={};var s=this;if(r(t,e,function(t,e){if(t[e.id+"_modified"]())switch(e.type){case"widget":return i.__properties[e.id]=s.serializeToObject(t[e.id](),null,o),!0;case"widgetArray":case"propertyArray":i.__properties[e.id]=[];var r=t[e.id]();return r.forEach(function(t,r){i.__properties[e.id].push(s.serializeToObject(t,null,o))}),!0;default:i.__properties[e.id]=t[e.id]()}}),"marshaller_Graph"===t.classID()){var n=t.data().vertices;n&&(this.__vertices=n.map(function(t){return this.serializeToObject(t,null,o)},this))}return o&&t.data&&(i.__data||(i.__data={}),i.__data.data=t.data()),i},serialize:function(t,e,o){return JSON.stringify(this.serializeToObject(t,e,o))},deserializeFromObject:function(t,e,o){var i=0,r=this;s(t,null,function(t,o){if(t[o.id+"_reset"](),void 0!==e.__properties[o.id])switch(o.type){case"widget":++i;var s=o.id;r.create(e.__properties[o.id],function(e){t[s](e),--i});break;case"widgetArray":case"propertyArray":var n=o.id,a=e.__properties[o.id];if(a.length){++i;var l=[];l.length=a.length;var p=0;a.forEach(function(e,o){++p,r.create(e,function(t){l[o]=t,--p});var s=setInterval(function(){0>=p&&(clearInterval(s),p=void 0,t[n](l),--i)},20)})}break;default:t[o.id](e.__properties[o.id])}});var n=setInterval(function(){if(0>=i){if(clearInterval(n),i=void 0,e.__data)for(var r in e.__data)t[r](e.__data[r]);o(t)}},20)},deserialize:function(t,e,o){"string"==typeof e&&(e=JSON.parse(e)),e.__id&&0!==e.__id.indexOf(t._idSeed)&&t._id!==e.__id&&console.log("Deserialize:  IDs do not match - "+t._id),this.deserializeFromObject(t,e,o)},create:function(e,o){"string"==typeof e&&(e=JSON.parse(e));var i=this;t.requireWidget(e.__class).then(function(t){var r=new t;e.__id&&0!==e.__id.indexOf(r._idSeed)&&0!==e.__id.indexOf("_pe")&&(r._id=e.__id),i.deserializeFromObject(r,e,o)})["catch"](function(t){console.log("Persist.create:  ***exception***"),console.log(t),o(null)})},clone:function(t,e){this.create(this.serializeToObject(t,[],!0),e)}}}),function(t,e){"function"==typeof define&&define.amd?define("other/PropertyEditor",["d3","../common/HTMLWidget","../other/Persist","../layout/Grid","../common/Widget","css!./PropertyEditor"],e):t.other_PropertyEditor=e(t.d3,t.common_HTMLWidget,t.other_Persist,t.layout_Grid,t.common_Widget)}(this,function(t,e,o,i,r){function s(t){switch(t){case"widget":case"widgetArray":case"propertyArray":return!0}return!1}function n(){e.call(this),this._parentPropertyEditor=null,this._tag="div",this._show_settings=!1}n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" other_PropertyEditor",n.prototype.publish("showFields",!1,"boolean","If true, widget.fields() will display as if it was a publish parameter.",null,{tags:["Basic"]}),n.prototype.publish("showData",!1,"boolean","If true, widget.data() will display as if it was a publish parameter.",null,{tags:["Basic"]}),n.prototype.publish("sorting","none","set","Specify the sorting type",["none","A-Z","Z-A","type"],{tags:["Basic"],icons:["fa-sort","fa-sort-alpha-asc","fa-sort-alpha-desc","fa-sort-amount-asc"]}),n.prototype.publish("hideNonWidgets",!1,"boolean","Hides non-widget params (at this tier only)",null,{tags:["Basic"]}),n.prototype.publish("label","","string","Label to display in header of property editor table",null,{tags:["Basic"]}),n.prototype.publish("filterTags","","set","Only show Publish Params of this type",["Basic","Intermediate","Advance",""],{}),n.prototype.publish("excludeTags",[],"array","Exclude this array of tags",null,{}),n.prototype.publish("excludeParams",[],"array","Exclude this array of params (widget.param)",null,{}),n.prototype.publish("widget",null,"widget","Widget",null,{tags:["Basic"],render:!1}),n.prototype.parentPropertyEditor=function(t){return arguments.length?(this._parentPropertyEditor=t,this):this._parentPropertyEditor},n.prototype._widgetOrig=n.prototype.widget,n.prototype.widget=function(t){if(arguments.length&&this._widgetOrig()===t)return this;var e=n.prototype._widgetOrig.apply(this,arguments);if(arguments.length&&(this.watchWidget(t),t instanceof i)){var o=this;t.postSelectionChange=function(){o._selectedItems=t._selectionBag.get().map(function(t){return t.widget}),o.render()}}return e},n.prototype.show_settings=function(t){return arguments.length?(this._show_settings=t,this):this._show_settings},n.prototype.rootWidgets=function(){return this._selectedItems&&this._selectedItems.length?this._selectedItems:this.show_settings()?[this]:this.widget()?[this.widget()]:[]},n.prototype.update=function(o,i){e.prototype.update.apply(this,arguments);var r=this,s=this.rootWidgets().filter(function(t){return t._owningWidget&&t._owningWidget.excludeObjs instanceof Array&&-1!==t._owningWidget.excludeObjs.indexOf(t.classID())?!1:!0}),n=i.selectAll(".table"+this.id()).data(s,function(t){return t.id()});n.enter().append("table").attr("class","property-table table"+this.id()).each(function(e){var o=t.select(this);o.append("thead").append("tr").append("th").datum(o).attr("colspan","2").each(function(e){var o=t.select(this);o.append("span"),r.thButtons(o)}),o.append("tbody")}),n.each(function(e){var o=t.select(this);o.select("thead > tr > th > span").text(function(t){var e="";return r.label()&&(e+=r.label()+": "),e+=t.classID()}),o.selectAll("i").classed("fa-eye",!r.hideNonWidgets()).classed("fa-eye-slash",r.hideNonWidgets()),r.renderInputs(o.select("tbody"),e)}),n.exit().each(function(t){r.renderInputs(i.select("tbody"),null)}).remove()},n.prototype.exit=function(t,o){e.prototype.exit.apply(this,arguments),this.watchWidget(null)};var a=0;return n.prototype.watchWidget=function(t){if(this._watch&&(window.__hpcc_debug&&(--a,console.log("watchDepth:  "+a)),this._watch.remove(),delete this._watch),t){var e=this;this._watch=t.monitor(function(t,o,i){i!==o&&e.lazyRender()}),window.__hpcc_debug&&(++a,console.log("watchDepth:  "+a))}},n.prototype.thButtons=function(t){var e=this,o=t.append("i").attr("class","fa fa-minus-square-o").on("click",function(t){t.classed("property-table-collapsed",!t.classed("property-table-collapsed")),o.classed("fa-minus-square-o",!t.classed("property-table-collapsed")).classed("fa-plus-square-o",t.classed("property-table-collapsed"))});if(null===this.parentPropertyEditor()){var i=t.append("i").attr("class","fa "+e.__meta_sorting.ext.icons[e.__meta_sorting.set.indexOf(e.sorting())]).on("click",function(){var t=e.sorting(),o=e.__meta_sorting.set,r=e.__meta_sorting.ext.icons;i.classed(r[o.indexOf(t)],!1).classed(r[(o.indexOf(t)+1)%o.length],!0),e.sorting(o[(o.indexOf(t)+1)%o.length]).render()}),r=t.append("i").attr("class","fa "+(e.hideNonWidgets()?"fa-eye-slash":"fa-eye")).on("click",function(){r.classed("fa-eye",e.hideNonWidgets()).classed("fa-eye-slash",!e.hideNonWidgets()),e.hideNonWidgets(!e.hideNonWidgets()).render()});r.classed("fa-eye",!e.hideNonWidgets()).classed("fa-eye-slash",e.hideNonWidgets())}},n.prototype.gatherDataTree=function(t){if(!t)return null;var e={label:t.id()+" ("+t.classID()+")",children:[]},i=o.discover(t);return i.forEach(function(o){var i={label:o.id,children:[]};switch(o.type){case"widget":i.children.push(this.gatherDataTree(t[o.id]()));break;case"widgetArray":case"propertyArray":var r=t[o.id]();r&&r.forEach(function(t){i.children.push(this.gatherDataTree(t))},this)}e.children.push(i)},this),e},n.prototype.getDataTree=function(){return this.gatherDataTree(this.rootWidget())},n.prototype._rowSorting=function(t){if("type"===this.sorting()){var e=["boolean","number","string","html-color","array","object","widget","widgetArray","propertyArray"];t.sort(function(t,o){return t.type===o.type?t.id<o.id?-1:1:e.indexOf(t.type)<e.indexOf(o.type)?-1:1})}else"A-Z"===this.sorting()?t.sort(function(t,e){return t.id<e.id?-1:1}):"Z-A"===this.sorting()&&t.sort(function(t,e){return t.id>e.id?-1:1})},n.prototype.filterInputs=function(t){var e=o.discover(t);if((this.filterTags()||this.excludeTags().length>0||this.excludeParams.length>0)&&t instanceof n==!1){var i=this;return e.filter(function(e,o){for(var r=0;r<i.excludeParams().length;r++){
var s,n,a,l=i.excludeParams()[r].split(".");if(l.length>2?(s=l[0],n=l[1],a=l[2]):(s=l[0],a=l[1]),-1!==t["class"]().indexOf(s))return e.id===a?!1:!0}return i.excludeTags().length>0&&e.ext&&e.ext.tags&&e.ext.tags.some(function(t){return i.excludeTags().indexOf(t)>-1})?!1:i.filterTags()&&e.ext&&e.ext.tags&&-1!==e.ext.tags.indexOf(i.filterTags())||!i.filterTags()?!0:!1})}return e},n.prototype.renderInputs=function(e,o){var i=this,r=[],n=!this.show_settings()&&this.showFields();o&&(r=this.filterInputs(o).filter(function(t){return"fields"!==t.id?!0:n}),!this.show_settings()&&this.showData()&&o.data&&r.push({id:"data",type:"array"}),this.hideNonWidgets()&&(r=r.filter(function(t){return s(t.type)})),this._rowSorting(r));var a=e.selectAll("tr.prop"+this.id()).data(r,function(t){return t.id});a.enter().append("tr").attr("class","property-wrapper prop"+this.id()).each(function(e){var r=t.select(this);if(s(e.type))r.classed("property-widget-wrapper",!0),r.append("td").attr("colspan","2");else{r.classed("property-input-wrapper",!0),r.append("td").classed("property-label",!0).text(e.id);var n=r.append("td").classed("property-input-cell",!0);i.enterInputs(o,n,e)}}),a.each(function(e){var r=t.select(this);r.classed("disabled",o[e.id+"_disabled"]&&o[e.id+"_disabled"]()),s(e.type)?i.updateWidgetRow(o,r.select("td"),e):i.updateInputs(o,e)}),a.exit().each(function(e){var r=t.select(this);s(e.type)&&i.updateWidgetRow(o,r.select("td"),null)}).remove(),a.order()},n.prototype.updateWidgetRow=function(e,o,i){var r=[];e&&i&&(r=e[i.id]()||[]);var s=r instanceof Array?r:[r],a=this,l=o.selectAll("div.propEditor"+this.id()).data(s,function(t){return t.id()});l.enter().append("div").attr("class","property-input-cell propEditor"+this.id()).each(function(e){t.select(this).attr("data-widgetid",e.id()).property("data-propEditor",(new n).label(i.id).target(this))}),l.each(function(e){t.select(this).property("data-propEditor").parentPropertyEditor(a).showFields(a.showFields()).showData(a.showData()).sorting(a.sorting()).filterTags(a.filterTags()).excludeTags(a.excludeTags()).excludeParams(a.excludeParams()).hideNonWidgets(a.hideNonWidgets()&&e._class.indexOf("layout_")>=0).widget(e).render()}),l.exit().each(function(e){var o=t.select(this);o.property("data-propEditor").widget(null).render().target(null),o.property("data-propEditor",null)}).remove()},n.prototype.setProperty=function(t,e,o){for(var i=this;i&&t;)if(i===this&&t[e](o),t.render){var r=i;t.render(function(t){r.render()}),i=null}else i=i.parentPropertyEditor(),t=i.widget()},n.prototype.enterInputs=function(e,o,i){o.classed(i.type+"-cell",!0);var r=this;switch(i.type){case"boolean":o.append("input").attr("id",this.id()+"_"+i.id).classed("property-input",!0).attr("type","checkbox").on("change",function(){r.setProperty(e,i.id,this.checked)});break;case"set":o.append("select").attr("id",this.id()+"_"+i.id).classed("property-input",!0).on("change",function(){r.setProperty(e,i.id,this.value)}).each(function(e){for(var o=t.select(this),r=0;r<i.set.length;r++)o.append("option").attr("value",i.set[r]).text(i.set[r])});break;case"array":case"object":o.append("textarea").attr("id",this.id()+"_"+i.id).classed("property-input",!0).on("change",function(){r.setProperty(e,i.id,JSON.parse(this.value))});break;default:o.append("input").attr("id",this.id()+"_"+i.id).classed("property-input",!0).on("change",function(){r.setProperty(e,i.id,this.value)}),"html-color"!==i.type||this.isIE||o.append("input").attr("id",this.id()+"_"+i.id+"_2").classed("property-input",!0).attr("type","color").on("change",function(){r.setProperty(e,i.id,this.value)})}},n.prototype.updateInputs=function(e,i){var s=t.selectAll("#"+this.id()+"_"+i.id+", #"+this.id()+"_"+i.id+"_2"),n=e?e[i.id]():"";switch(s.property("disabled",e[i.id+"_disabled"]&&e[i.id+"_disabled"]()),i.type){case"array":case"object":s.property("value",JSON.stringify(n,function(t,e){return e instanceof r?o.serialize(e):e}));break;case"boolean":s.property("checked",n);break;default:s.property("value",n)}},n}),function(t,e){"function"==typeof define&&define.amd?define("other/ThemeEditor.js",["../common/Widget","../common/HTMLWidget","./Persist","./PropertyEditor","css!./ThemeEditor"],e):t.other_PropertyEditor=e(t.common_Widget,t.common_HTMLWidget,t.other_Persist,t.other_PropertyEditor)}(this,function(t,e,o,i){function r(){e.call(this),this._tag="div",this._current_grouping=void 0,this._showing_columns=void 0,this._showing_data=void 0,this.columns(["Key","Value"]),this._contentEditors=[],this._showSettings=!0,this._defaultThemes=[],this._widgetObjsById={}}function s(t){var e=t.split(/(?=[0-9A-Z])/).map(function(t){return t.length>1?t+" ":t}).join("");return e.replace(/(?:^|\s)\S/g,function(t){return t.toUpperCase()})}function n(t,e,o,i){function r(t,e){var o="";return t.set.forEach(function(t){var i=t===e?" selected":"";o+="<option value='"+t+"'"+i+">"+t+"</option>"}),o}var s,n="",a="te-input-"+t.id+"-"+i;"undefined"!=typeof t.ext&&"undefined"!=typeof t.ext.inputType&&(s=t.ext.inputType),"undefined"!=typeof t.inputID&&(a=t.inputID);var l="data-paramid='"+t.id+"' data-wids='"+o.map(function(t){return"object"==typeof t.widget?t.widget._id:t}).join(",")+"'";switch(t.type){case"boolean":var p=e?" checked":"";n="<input id='"+a+"' "+l+" type='checkbox' class='te-checkbox te-input'"+p+">";break;case"number":"undefined"!=typeof s?"textarea"===s?n="<textarea id='"+a+"' class='te-textarea te-input' "+l+">"+e+"</textarea>":"range"===s&&(n="<input id='"+a+"' class='te-input' type='range' "+l+" value='"+e+"'  min='"+t.ext.min+"' max='"+t.ext.max+"' step='"+t.ext.step+"'>"):n="<input id='"+a+"' type='text' class='te-text te-input' "+l+" value='"+e+"'>";break;case"string":"undefined"!=typeof s?"textarea"===s&&(n="<textarea id='"+a+"' class='te-textarea te-input' "+l+">"+e+"</textarea>"):n="<input id='"+a+"' type='text' class='te-text te-input' value='"+e+"' "+l+">";break;case"html-color":var u=""===e?"":" value='"+e+"'";n="<input id='"+a+"' type='text' class='te-html-color-input te-input' "+l+" "+u+">",n+="<input type='color' class='te-html-color-button te-input' "+l+" "+u+">";break;case"set":var h=r(t,e);n="<select id='"+a+"' class='te-select te-input'"+l+">"+h+"</select>";break;case"array":n="<textarea id='"+a+"' class='te-textarea te-input' data-type='array' "+l+">"+e+"</textarea>"}return"undefined"!=typeof t.ext.saveButton&&(n+="<button id='"+t.ext.saveButtonID+"'>"+t.ext.saveButton+"</button>"),n}var a=function(t){return"function"==typeof window.g_defaultThemes&&window.g_defaultThemes(t),JSON.parse(localStorage.getItem("themeEditorThemes")||"{}")},l=function(t){return"function"==typeof window.g_defaultSerials&&window.g_defaultSerials(t),JSON.parse(localStorage.getItem("themeEditorSerials")||"{}")},p=function(t){var e=a(),o=[];for(var i in e)o.push(i);return"undefined"!=typeof t&&"undefined"!=typeof o[t]&&(o=o[t]),o},u=function(t){var e=l(),o=[];for(var i in e)o.push(i);return"undefined"!=typeof t&&"undefined"!=typeof o[t]&&(o=o[t]),o};r.prototype=Object.create(e.prototype),r.prototype._class+=" other_ThemeEditor",r.prototype.publish("themeMode",!0,"boolean","Edit default values",null,{tags:["Basic"]}),r.prototype.publish("saveTheme","","string","Save Theme",null,{tags:["Basic","Theme"],saveButton:"Save",saveButtonID:"te-save-button"}),r.prototype.publish("loadedTheme",p(1),"set","Loaded Theme",p(),{tags:["Basic","Theme"]}),r.prototype.publish("saveSerial","","string","Save Serial",null,{tags:["Basic","Serial"],saveButton:"Save",saveButtonID:"te-save-button"}),r.prototype.publish("loadedSerial",u(0),"set","Loaded Serial",u(),{tags:["Basic","Serial"]}),r.prototype.publish("showColumns",!0,"boolean","Show Columns",null,{tags:["Intermediate"]}),r.prototype.publish("showData",!0,"boolean","Show Data",null,{tags:["Intermediate"]}),r.prototype.publish("shareCountMin",1,"number","Share Count Min",null,{tags:["Private"]}),r.prototype.publish("paramGrouping","By Param","set","Param Grouping",["By Param","By Widget"],{tags:["Private"]}),r.prototype.publish("editorComplexity","Basic","set","Choose what publish properties to display within the editor.",["Basic","Intermediate","Advanced","Private"],{tags:["Private"]}),r.prototype.publish("sectionTitle","","string","Section Title",null,{tags:["Private"]}),r.prototype.publish("collapsibleSections",!0,"boolean","Collapsible Sections",null,{tags:["Intermediate"]}),r.prototype.getThemes=a,r.prototype.getSerials=l,r.prototype.getDefaultThemes=p,r.prototype.getDefaultSerials=u,r.prototype.showSettings=function(t){return arguments.length?(this._showSettings=t,this):this._showSettings},r.prototype.onChange=function(t,e){},r.prototype.enter=function(t,o){e.prototype.enter.apply(this,arguments),this._parentElement.style("overflow","auto")};var h=function(t){var e=!1;return"undefined"==typeof t._current_grouping?t._current_grouping=t._group_params_by:t._current_grouping!==t._group_params_by&&(e=!0),"undefined"==typeof t._showing_columns?t._showing_columns=t.showColumns():t._showing_columns!==t.showColumns()&&(e=!0),"undefined"==typeof t._showing_data?t._showing_data=t.showData():t._showing_data!==t.showData()&&(e=!0),e};return r.prototype.widgetProperty=function(t,e,o){return void 0===o?t[e]():t[e](o)},r.prototype.load=function(){},r.prototype.save=function(){},r.prototype.needsPropTableRedraw=function(t,e){var o=null===document.getElementById("te-themeEditorOptions");return o},r.prototype.update=function(t,i){e.prototype.update.apply(this,arguments),h(this)&&i.selectAll("#"+this._id+" > table").remove(),this._current_grouping=this.paramGrouping(),this._widgetObjsById[this._id]=this,this._sharedProperties=this.findSharedProperties(this.data());var r=this.needsPropTableRedraw();if(r&&this.showSettings()){var s=o.discover(this);for(var a in s)if(-1!==s[a].ext.tags.indexOf(this.editorComplexity())){var l=this[s[a].id]();("loadedTheme"===s[a].id||"loadedSerial"===s[a].id)&&(s[a].inputID="te-load-theme"),s[a].input=n(s[a],l,[this._id],this._id)}else delete s[a];t.innerHTML=this.propertiesTableHtml(s);var p=document.createEvent("Events");p.initEvent("TE Properties Ready",!0,!0),document.dispatchEvent(p)}this.buildTableObjects(t,this._sharedProperties),this.initFunctionality(t)},r.prototype.exit=function(t,o){e.prototype.exit.apply(this,arguments)},r.prototype.click=function(t){},r.prototype.propertiesTableHtml=function(t){var e={id:"te-themeEditorOptions",label:"Editor Options",rowArr:[]},o={id:"te-tableModeOptions",label:this.themeMode()?"Save/Load Theme":"Save/Load Serial",rowArr:[]};for(var i in t)this.themeMode()?-1===t[i].ext.tags.indexOf("Theme")&&-1===t[i].ext.tags.indexOf("Serial")?e.rowArr.push({th:s(t[i].id),td:t[i].input,trClass:"propertyRow"}):-1!==t[i].ext.tags.indexOf("Theme")&&o.rowArr.push({th:s(t[i].id),td:t[i].input,trClass:"propertyRow"}):-1===t[i].ext.tags.indexOf("Serial")&&-1===t[i].ext.tags.indexOf("Theme")?e.rowArr.push({th:s(t[i].id),td:t[i].input,trClass:"propertyRow"}):-1!==t[i].ext.tags.indexOf("Serial")&&o.rowArr.push({th:s(t[i].id),td:t[i].input,trClass:"propertyRow"});var r="";return e.rowArr.length>0&&(r+=this.tableObjHtml(e)),o.rowArr.length>0&&(r+=this.tableObjHtml(o)),r},r.prototype.buildTableObjects=function(t,e){var o={};o=this.themeMode()?{chartColorSection:{id:"te-colorOptions",label:"Chart Colors",rowObjArr:[]},surfaceSection:{id:"te-containerOptions",label:"Container Styles/Colors",rowObjArr:[]},fontSection:{id:"te-fontOptions",label:"Font Styles/Colors",rowObjArr:[]}}:{nonSurfaceSection:{id:"te-chartOptions",label:"Chart Properties",rowObjArr:[]}};for(var i in e)this.themeMode()?-1===i.toUpperCase().indexOf("FONT")||-1!==e[i].arr[0].widget._class.indexOf("layout_Surface")&&-1!==i.toUpperCase().indexOf("COLOR")?"paletteID"===i?o.chartColorSection.rowObjArr.push(e[i]):-1!==e[i].arr[0].widget._class.indexOf("layout_Surface")&&o.surfaceSection.rowObjArr.push(e[i]):o.fontSection.rowObjArr.push(e[i]):-1===e[i].arr[0].widget._class.indexOf("layout_Surface")&&o.nonSurfaceSection.rowObjArr.push(e[i]);var r="";for(var s in o)r+=this.sharedPropertyTableHtml(o[s]);t.innerHTML+=r},r.prototype.initFunctionality=function(t){function e(t){if(r.showSettings()){var e=document.getElementById("te-save-button");e.onclick=function(t){var e=t.srcElement,o=e.previousSibling.value;if(o.length>1){var i,s=document.getElementById("te-load-theme"),n=s.getElementsByTagName("option"),a=!1;for(var l in n){var p=n[l].value;p===o&&(a=!0)}if(a){var u=confirm("'"+o+"' already exists. Do you want to overwrite the existing save? ");u&&(i=r.save(o))}else i=r.save(o),s.innerHTML+="<option value='"+o+"'>"+o+"</option>";e.previousSibling.value="",s.value=o}else alert("Save Name cannot be empty.")}}}function o(t){var e=t.getElementsByClassName("te-input");for(var o in e){if(isNaN(parseInt(o)))break;var i=e[o],s=i.getAttribute("id");"te-load-theme"===s?i.onchange=function(t){var e=t.srcElement;r.load(e.value)}:null!==s&&-1!==s.indexOf("te-input-themeMode")?i.onchange=function(t){var e=t.srcElement;r.themeMode(e.checked);var o=document.getElementById("te-load-theme"),i=null!==o?o.value:"Default";r.load(i)}:("INPUT"===i.tagName||"SELECT"===i.tagName||"TEXTAREA"===i.tagName)&&(i.onchange=function(t){var e=t.srcElement,o=e.getAttribute("id");-1!==e.className.split(" ").indexOf("te-html-color-button")&&(o=e.previousSibling.getAttribute("id"),e.previousSibling.value=e.value);var i=e.getAttribute("type"),s=o.split("-"),n=s.slice(0,s.length-1).join("-")+"-",a=e.getAttribute("data-wids"),l=e.getAttribute("data-paramid"),p=a.split(",");p.forEach(function(t){var o=n+t,s=document.getElementById(o);if("checkbox"===i)s.checked=e.checked,r._widgetObjsById[t][l](e.checked);else if("array"===e.getAttribute("data-type")){s.value=e.value;try{r._widgetObjsById[t][l](JSON.parse(e.value))}catch(a){}}else s.value=e.value,r._widgetObjsById[t][l](e.value),-1!==s.className.split(" ").indexOf("te-html-color-input")?s.nextSibling.value=e.value:-1!==s.className.split(" ").indexOf("te-html-color-button")&&(s.previousSibling.value=e.value)}),r.data().forEach(function(t){t.render()})})}}function i(t){var e=t.getElementsByClassName("te-section-table");for(var o in e)if("function"==typeof e[o].getElementsByTagName){var i=e[o].getElementsByTagName("thead");i[0].onclick=function(t){var e=t.toElement;"TH"===e.tagName&&(e=e.parentElement.parentElement);var o=e.parentElement,i="";-1===o.className.split(" ").indexOf("expanded")?(o.className="te-section-table expanded",i="shown"):(o.className="te-section-table collapsed",i="hidden");var r=o.getElementsByTagName("tbody");r[0].className=i}}var r=t.getElementsByClassName("sharedPropertyRow");for(var s in r)if("function"==typeof r[s].getElementsByClassName){var n=r[s].getElementsByClassName("te-label");n[0].onclick=function(t){var e=t.toElement,o=e.parentElement,i="";-1===o.className.split(" ").indexOf("expanded")?(o.className="sharedPropertyRow expanded",i="shown"):(o.className="sharedPropertyRow collapsed",i="hidden");for(var r=o.nextSibling;null!==r;)-1===r.className.split(" ").indexOf("sharedPropertyRow")?(r.className="propertyRow "+i,r=r.nextSibling):r=null}}}var r=this;i(t),o(t),e(t)},r.prototype.sharedPropertyTableHtml=function(t){function e(t){var e=t.widget.classID().split("_"),o=e.join("/");return o+" <i>["+t.widget._id+"]</i>"}function o(t){return s(t.id)}function i(t,e){function o(t,e){var o=t.arr[e].widget[t.id]();return null!==o?o:""}var i=o(t,e),r=n(t,i,[t.arr[e]],t.arr[e].widget._id);return r}function r(t){function e(t){var e=t.arr[0].widget[t.id]();return t.arr.forEach(function(t,o){return e!==t.widget[t.id]()?"":void 0}),null!==e?"array"===t.type?JSON.stringify(e):e:""}var o=e(t),i=n(t,o,t.arr,"shared");return i}var a={id:t.id,label:t.label,rowArr:[]};return t.rowObjArr.forEach(function(t){t.arr.forEach(function(s,n){0===n&&a.rowArr.push({th:o(t),td:r(t),trClass:"sharedPropertyRow collapsed"}),a.rowArr.push({th:e(s),td:i(t,n),trClass:"propertyRow hidden"})})}),this.tableObjHtml(a)},r.prototype.tableObjHtml=function(t){var e="<table id='"+t.id+"' class='te-section-table expanded'>";return e+="<thead><tr><th colspan='2'>"+t.label+"</th></tr></thead>",e+="<tbody>",t.rowArr.forEach(function(t){e+=this.tableRowObjHtml(t)},this),e+="</tbody>",e+"</table>"},r.prototype.tableRowObjHtml=function(t){var e="undefined"!=typeof t.trClass?"<tr class='"+t.trClass+"'>":"<tr>";return e+="<th class='te-label'>"+t.th+"</th>",e+="<td>"+t.td+"</td>",e+"</tr>"},r.prototype.setWidgetObjsById=function(t){var e=this,o=t.widget[t.id]();"widgetArray"===t.type?o.forEach(function(t){e._widgetObjsById[t._id]=t}):"widget"===t.type&&null!==o&&(this._widgetObjsById[o._id]=o)},r.prototype.checkTagFilter=function(t){var e=["Basic"],o=!1;return t.forEach(function(t){-1!==e.indexOf(t)&&(o=!0)}),o},r.prototype.findSharedProperties=function(t){function e(t,i){var s=[];if(null!==t){var n=o.discover(t);n.forEach(function(o,n){if("undefined"!=typeof o.ext.tags&&s.push({id:o.id,type:o.type,description:o.description,set:o.set,ext:o.ext,widget:t}),"widgetArray"===o.type){var a=r.widgetProperty(t,o.id);a.forEach(function(t){var o=e(t,i+1);s=s.concat(o)})}else if("widget"===o.type){var l=r.widgetProperty(t,o.id),p=e(l,i+1);s=s.concat(p)}})}return s}var i,r=this;if("undefined"!=typeof t&&t.length>0){var s=[];i={};var n={},a={};t.forEach(function(t){var o=e(t,0);s=s.concat(o)}),s.forEach(function(t){if(-1!==["widget","widgetArray"].indexOf(t.type))r.setWidgetObjsById(t);else if(r.checkTagFilter(t.ext.tags)){var e=t.id;-1!==t.widget._class.indexOf("Surface")?("undefined"==typeof n[e]&&(n[e]={arr:[]}),n[e].id=t.id,n[e].description=t.description,n[e].type=t.type,n[e].set=t.set,n[e].ext=t.ext,n[e].arr.push(t)):("undefined"==typeof a[e]&&(a[e]={arr:[]}),a[e].id=t.id,a[e].description=t.description,a[e].type=t.type,a[e].set=t.set,a[e].ext=t.ext,a[e].arr.push(t)),"undefined"==typeof i[e]&&(i[e]={arr:[]}),i[e].id=t.id,i[e].description=t.description,i[e].type=t.type,i[e].set=t.set,i[e].ext=t.ext,i[e].arr.push(t)}})}return i},r}),function(t,e){"function"==typeof define&&define.amd?define("other/WordCloud.js",["d3","../common/SVGWidget","../api/I2DChart","../api/ITooltip","d3-cloud","css!./WordCloud"],e):t.other_WordCloud=e(t.d3,t.common_SVGWidget,t.api_I2DChart,t.api_ITooltip,t.d3.layout.cloud)}(this,function(t,e,o,i,r){function s(){e.call(this),o.call(this),i.call(this),this._prevOffsetX=this.offsetX(),this._prevOffsetY=this.offsetY(),this._prevZoom=this.zoom()}return s.prototype=Object.create(e.prototype),s.prototype.constructor=s,s.prototype._class+=" other_WordCloud",s.prototype["implements"](o.prototype),s.prototype["implements"](i.prototype),s.prototype.publish("paletteID","default","set","Palette ID",s.prototype._palette["switch"](),{tags:["Basic","Shared"]}),s.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),s.prototype.publish("fontFamily","Impact","string","Font Name",null,{tags:["Basic"]}),s.prototype.publish("fontSizeFrom",6,"number","Font Size From",null,{tags:["Basic"]}),s.prototype.publish("fontSizeTo",48,"number","Font Size To",null,{tags:["Basic"]}),s.prototype.publish("angleFrom",-60,"number","Angle From",null,{tags:["Basic"]}),s.prototype.publish("angleTo",60,"number","Angle To",null,{tags:["Basic"]}),s.prototype.publish("angleCount",5,"number","Angle Count",null,{tags:["Basic"]}),s.prototype.publish("padding",0,"number","Padding",null,{tags:["Intermediate"]}),s.prototype.publish("scaleMode","linear","set","Text scaling mode",["linear","log","sqrt","pow"],{tags:["Intermediate"]}),s.prototype.publish("spiral","archimedean","set","Text scaling mode",["archimedean","rectangular"],{tags:["Intermediate"]}),s.prototype.publish("offsetX",0,"number","X offset",null,{tags:["Advanced"]}),s.prototype.publish("offsetY",0,"number","Y offset",null,{tags:["Advanced"]}),s.prototype.publish("zoom",1,"number","Zoom",null,{tags:["Advanced"]}),s.prototype.data=function(t){var o=e.prototype.data.apply(this,arguments);return arguments.length&&(this._vizData=t.map(function(t){var e={};for(var o in t)e["__viz_"+o]=t[o];return e})),o},s.prototype.enter=function(o,i){e.prototype.enter.apply(this,arguments),this._root=i.append("g"),this._canvas=document.createElement("canvas");var s=this;this._zoom=t.behavior.zoom().scaleExtent([.1,10]).on("zoom",function(){s.zoomed(s._zoom,t.event.translate,t.event.scale)}),i.call(this._zoom),this._cloud=(new r).canvas(this._canvas)},s.prototype.update=function(o,i){function r(t,e){var o=s._root.selectAll("text").data(t,function(t){return t.__viz_0?t.__viz_0.toLowerCase():""});o.enter().append("text").attr("text-anchor","middle").text(function(t){return t.__viz_0}).on("click",function(t){s.click({label:t.__viz_0,weight:t.__viz_1})}).style("opacity",1e-6).on("mouseover.tooltip",function(t){s.tooltipShow([t.__viz_0,t.__viz_1],s.columns(),1)}).on("mouseout.tooltip",function(t){s.tooltipShow()}).on("mousemove.tooltip",function(t){s.tooltipShow([t.__viz_0,t.__viz_1],s.columns(),1)}),o.style("font-size",function(t){return a(t.__viz_1)+"px"}).style("font-family",s.fontFamily()).transition().duration(1e3).attr("transform",function(t){return"translate("+[t.x,t.y]+")rotate("+t.rotate+")"}).style("fill",function(t){return s._palette(t.__viz_0?t.__viz_0.toLowerCase():"")}).style("opacity",1),o.exit().transition().duration(1e3).style("opacity",1e-4).remove()}e.prototype.update.apply(this,arguments),this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this.zoomed(this,[this.offsetX(),this.offsetY()],this.zoom());var s=this,n=t.extent(this._vizData,function(t){return t.__viz_1}),a=t.scale[this.scaleMode()]().domain(n).range([this.fontSizeFrom(),this.fontSizeTo()]),l=t.scale.linear().domain([0,s.angleCount()-1]).range([s.angleFrom(),s.angleTo()]);this._cloud.stop().size([this.width(),this.height()]).words(this._vizData).font(this.fontFamily()).padding(this.padding()).spiral(this.spiral()).text(function(t){return t.__viz_0}).fontSize(function(t){return a(t.__viz_1)}).rotate(function(){return l(~~(Math.random()*s.angleCount()))}).on("end",r).start()},s.prototype.zoomed=function(t,e,o){if(e[0]!==this._prevOffsetX||e[1]!==this._prevOffsetY||o!==this._prevZoom){switch(this._root.attr("transform","translate("+e[0]+","+e[1]+")scale("+o+")"),t){case this:this._zoom.scale(o).translate(e);break;case this._zoom:this.offsetX(e[0]),this.offsetY(e[1]),this.zoom(o)}this._prevOffsetX=e[0],this._prevOffsetY=e[1],this._prevZoom=o}},s});