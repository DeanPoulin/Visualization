!function(t,e){"function"==typeof define&&define.amd?define(["d3","../common/SVGWidget","./XYAxis","../api/INDChart","../api/ITooltip","../common/Palette","d3-hexbin","css!./HexBin"],e):t.chart_HexBin=e(t.d3,t.common_SVGWidget,t.chart_XYAxis,t.api_INDChart,t.api_ITooltip,t.common_Palette)}(this,function(t,e,i,o,a,n,s){function r(t){i.call(this),o.call(this),a.call(this),this._hexbin=new s}return s=s||t.hexbin||window.d3.hexbin,r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype._class+=" chart_HexBin",r.prototype["implements"](o.prototype),r.prototype["implements"](a.prototype),r.prototype._palette=n.rainbow("default"),r.prototype.publish("paletteID","Blues","set","Palette ID",r.prototype._palette["switch"](),{tags:["Basic","Shared"]}),r.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),r.prototype.publish("binSize",20,"number","Bin radius"),r.prototype.xPos=function(t){return"horizontal"===this.orientation()?this.dataPos(t.label):this.valuePos(t.value)},r.prototype.yPos=function(t){return"horizontal"===this.orientation()?this.valuePos(t.value):this.dataPos(t.label)},r.prototype.updateChart=function(e,i,o,a,n,s){var r=this;this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this._hexbin.size([a,n]).radius(this.binSize());var l=this.flattenData(),p=l.map(function(t,e){return[r.xPos(t),r.yPos(t)]}),h=this._hexbin(p),u=t.max(h,function(t){return t.length}),c=this.svgData.selectAll(".hexagon").data(h);c.enter().append("path").attr("class","hexagon").attr("transform",function(t){return"translate("+t.x+","+t.y+")scale(0)"}),c.transition().attr("d",this._hexbin.hexagon()).attr("transform",function(t){return"translate("+t.x+","+t.y+")scale(1)"}).style("fill",function(t){return r._palette(t.length,0,u)}),c.exit().transition().attr("transform",function(t){return"translate("+t.x+","+t.y+")scale(0)"}).remove()},r.prototype.exit=function(t,i){e.prototype.exit.apply(this,arguments)},r});