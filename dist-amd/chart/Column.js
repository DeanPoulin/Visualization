(function(e,t){typeof define=="function"&&define.amd?define(["d3","./XYAxis","../api/INDChart","../api/ITooltip","css!./Column"],t):e.chart_Column=t(e.d3,e.chart_XYAxis,e.api_INDChart,e.api_ITooltip)})(this,function(e,t,n,r){function i(e){t.call(this),n.call(this),r.call(this),this._linearGap=25}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" chart_Column",i.prototype.implements(n.prototype),i.prototype.implements(r.prototype),i.prototype.publish("paletteID","default","set","Palette ID",i.prototype._palette.switch(),{tags:["Basic","Shared"]}),i.prototype.publish("stacked",!1,"boolean","Stacked Bars",null,{tags:["Basic"]}),i.prototype.publish("stackedOpacity",.66,"number","Fill Stacked Opacity",null,{tags:["Basic"]}),i.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),i.prototype.updateChart=function(t,n,r,i,s){var o=this;this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()));var u=10,a=0;switch(this.xAxisType()){case"ordinal":u=this.dataScale.rangeBand(),a=0;break;case"linear":case"time":u=Math.max(Math.abs(this.dataScale(2)-this.dataScale(1))*(100-this._linearGap)/100,u),a=-u/2}var f=e.scale.ordinal().domain(o._columns.filter(function(e,t){return t>0})).rangeRoundBands([0,u]),l=this.svgData.selectAll(".dataRow").data(this.formattedData());l.enter().append("g").attr("class","dataRow"),l.each(function(t,n){var r=e.select(this),i=r.selectAll("rect").data(t.map(function(e,n){return{column:o._columns[n],row:t,value:e,idx:n}}).filter(function(e,t){return e.value!==null&&e.idx>0}));i.enter().append("rect").attr("class","columnRect").call(o._selection.enter.bind(o._selection)).on("mouseover.tooltip",function(e){o.tooltipShow(t,o._columns,e.idx)}).on("mouseout.tooltip",function(e){o.tooltipShow()}).on("mousemove.tooltip",function(e){o.tooltipShow(t,o._columns,e.idx)}).on("click",function(e,n){o.click(o.rowToObj(t),e.column,o._selection.selected(this))}),o.orientation()==="horizontal"?i.transition().attr("class","columnRect").attr("x",function(e){return o.dataScale(t[0])+(o.stacked()?0:f(e.column))+a}).attr("width",o.stacked()?u:f.rangeBand()).attr("y",function(e){return e.value instanceof Array?o.valueScale(e.value[1]):o.valueScale(e.value)}).attr("height",function(e){return e.value instanceof Array?o.valueScale(e.value[0])-o.valueScale(e.value[1]):s-o.valueScale(e.value)}).style("opacity",o.stacked()?o.stackedOpacity():1).style("fill",function(e){return o._palette(e.column)}):i.transition().attr("class","columnRect").attr("y",function(e){return o.dataScale(t[0])+(o.stacked()?0:f(e.column))+a}).attr("height",o.stacked()?u:f.rangeBand()).attr("x",function(e){return e.value instanceof Array?o.valueScale(e.value[0]):0}).attr("width",function(e){return e.value instanceof Array?o.valueScale(e.value[1])-o.valueScale(e.value[0]):o.valueScale(e.value)}).style("opacity",o.stacked()?o.stackedOpacity():1).style("fill",function(e){return o._palette(e.column)}),o.stacked()&&i.sort(function(e,t){return t-e}),i.exit().transition().remove()}),l.exit().transition().remove()},i});