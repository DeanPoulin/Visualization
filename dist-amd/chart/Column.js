!function(t,e){"function"==typeof define&&define.amd?define(["d3","./XYAxis","../api/INDChart","../api/ITooltip","css!./Column"],e):t.chart_Column=e(t.d3,t.chart_XYAxis,t.api_INDChart,t.api_ITooltip)}(this,function(t,e,a,l){function n(t){e.call(this),a.call(this),l.call(this),this._linearGap=25}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" chart_Column",n.prototype["implements"](a.prototype),n.prototype["implements"](l.prototype),n.prototype.publish("paletteID","default","set","Palette ID",n.prototype._palette["switch"](),{tags:["Basic","Shared"]}),n.prototype.publish("stacked",!1,"boolean","Stacked Bars",null,{tags:["Basic"]}),n.prototype.publish("stackedOpacity",.66,"number","Fill Stacked Opacity",null,{tags:["Basic"]}),n.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),n.prototype.updateChart=function(e,a,l,n,o,i){var c=this;this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()));var r=10,s=0;switch(this.xAxisType()){case"ordinal":r=this.dataScale.rangeBand(),s=0;break;case"linear":case"time":r=Math.max(Math.abs(this.dataScale(2)-this.dataScale(1))*(100-this._linearGap)/100,r),s=-r/2}var u=t.scale.ordinal().domain(c.columns().filter(function(t,e){return e>0})).rangeRoundBands(i?[0,r]:[r,0]),p=this.svgData.selectAll(".dataRow").data(this.formattedData());p.enter().append("g").attr("class","dataRow"),p.each(function(e,a){var l=t.select(this),n=l.selectAll("rect").data(e.filter(function(t,e){return e<c.columns().length}).map(function(t,a){return{column:c.columns()[a],row:e,value:t,idx:a}}).filter(function(t,e){return null!==t.value&&t.idx>0}));n.enter().append("rect").attr("class","columnRect").call(c._selection.enter.bind(c._selection)).on("mouseover.tooltip",function(t){c.tooltipShow(t.row,c.columns(),t.idx)}).on("mouseout.tooltip",function(t){c.tooltipShow()}).on("mousemove.tooltip",function(t){c.tooltipShow(t.row,c.columns(),t.idx)}).on("click",function(t,e){c.click(c.rowToObj(t.row),t.column,c._selection.selected(this))}),i?n.transition().attr("x",function(t){return c.dataScale(e[0])+(c.stacked()?0:u(t.column))+s}).attr("width",c.stacked()?r:u.rangeBand()).attr("y",function(t){return t.value instanceof Array?c.valueScale(t.value[1]):c.valueScale(t.value)}).attr("height",function(t){return t.value instanceof Array?c.valueScale(t.value[0])-c.valueScale(t.value[1]):o-c.valueScale(t.value)}).style("opacity",c.stacked()?c.stackedOpacity():1).style("fill",function(t){return c._palette(t.column)}):n.transition().attr("y",function(t){return c.dataScale(e[0])+(c.stacked()?0:u(t.column))+s}).attr("height",c.stacked()?r:u.rangeBand()).attr("x",function(t){return t.value instanceof Array?c.valueScale(t.value[0]):0}).attr("width",function(t){return t.value instanceof Array?c.valueScale(t.value[1])-c.valueScale(t.value[0]):c.valueScale(t.value)}).style("opacity",c.stacked()?c.stackedOpacity():1).style("fill",function(t){return c._palette(t.column)}),c.stacked()&&n.sort(function(t,e){return e-t}),n.exit().transition().remove()}),p.exit().transition().remove()},n});