!function(t,e){"function"==typeof define&&define.amd?define(["d3","./XYAxis","../api/INDChart","../api/ITooltip","css!./Column"],e):t.chart_Column=e(t.d3,t.chart_XYAxis,t.api_INDChart,t.api_ITooltip)}(this,function(t,e,a,o){function n(t){e.call(this),a.call(this),o.call(this),this._linearGap=25}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" chart_Column",n.prototype["implements"](a.prototype),n.prototype["implements"](o.prototype),n.prototype.publish("paletteID","default","set","Palette ID",n.prototype._palette["switch"](),{tags:["Basic","Shared"]}),n.prototype.publish("stacked",!1,"boolean","Stacked Bars",null,{tags:["Basic"]}),n.prototype.publish("stackedOpacity",.66,"number","Fill Stacked Opacity",null,{tags:["Basic"]}),n.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),n.prototype.enter=function(t,a){e.prototype.enter.apply(this,arguments);var o=this;this.tooltipHTML(function(t){return o.tooltipFormat({label:t.row[0],series:o.columns()[t.idx],value:t.row[t.idx]})})},n.prototype.updateChart=function(e,a,o,n,i,l){var s=this;this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()));var r=10,c=0;switch(this.xAxisType()){case"ordinal":r=this.domainAxis.d3Scale.rangeBand(),c=-r/2;break;case"linear":case"time":r=Math.max(Math.abs(this.dataPos(2)-this.dataPos(1))*(100-this._linearGap)/100,r),c=-r/2}var u=t.scale.ordinal().domain(s.columns().filter(function(t,e){return e>0})).rangeRoundBands(l?[0,r]:[r,0]),p=this.svgData.selectAll(".dataRow").data(this.data());p.enter().append("g").attr("class","dataRow"),this.tooltip.direction(l?"n":"e"),p.each(function(e,a){var o=t.select(this),n=o.selectAll("rect").data(e.filter(function(t,e){return e<s.columns().length}).map(function(t,a){return{column:s.columns()[a],row:e,value:t,idx:a}}).filter(function(t,e){return null!==t.value&&t.idx>0}));n.enter().append("rect").attr("class","columnRect").call(s._selection.enter.bind(s._selection)).on("mouseout.tooltip",s.tooltip.hide).on("mousemove.tooltip",s.tooltip.show).on("click",function(t,e){s.click(s.rowToObj(t.row),t.column,s._selection.selected(this))}),l?n.transition().attr("x",function(t){return s.dataPos(e[0])+(s.stacked()?0:u(t.column))+c}).attr("width",s.stacked()?r:u.rangeBand()).attr("y",function(t){return t.value instanceof Array?s.valuePos(t.value[1]):s.valuePos(t.value)}).attr("height",function(t){return t.value instanceof Array?s.valuePos(t.value[0])-s.valuePos(t.value[1]):i-s.valuePos(t.value)}).style("opacity",s.stacked()?s.stackedOpacity():1).style("fill",function(t){return s._palette(t.column)}):n.transition().attr("y",function(t){return s.dataPos(e[0])+(s.stacked()?0:u(t.column))+c}).attr("height",s.stacked()?r:u.rangeBand()).attr("x",function(t){return t.value instanceof Array?s.valuePos(t.value[0]):0}).attr("width",function(t){return t.value instanceof Array?s.valuePos(t.value[1])-s.valuePos(t.value[0]):s.valuePos(t.value)}).style("opacity",s.stacked()?s.stackedOpacity():1).style("fill",function(t){return s._palette(t.column)}),s.stacked()&&n.sort(function(t,e){return e-t}),n.exit().transition().remove()}),p.exit().transition().remove()},n});