!function(t,o){"function"==typeof define&&define.amd?define(["d3","topojson","./Layer","./Utility","../common/Palette","../common/Utility","css!./Pins"],o):t.map_Pins=o(t.d3,t.topojson,t.map_Layer,t.map_Utility,t.common_Palette,t.common_Utility)}(this,function(t,o,e,i,n,s){function r(){e.call(this)}return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype._class+=" map_Pins",r.prototype.publish("opacity",1,"number","Opacity",null,{tags:["Advanced"]}),r.prototype.publish("pinColor","#006ccc","html-color","Pin Color",null,{optional:!0}),r.prototype.publish("meshStrokeWidth",.25,"number","Stroke Width"),r.prototype.layerEnter=function(o,i,n){e.prototype.layerEnter.apply(this,arguments),this._pinsTransform=i,this._selection=new s.SimpleSelection(this._pinsTransform),this.pinsPaths=t.select(null)},r.prototype.layerUpdate=function(t){e.prototype.layerUpdate.apply(this,arguments),this._pinsTransform.style("opacity",this.opacity()),this.pinsPaths=this._pinsTransform.selectAll(".data").data(this.visible()?this.data():[],function(t){return t[0]});var o=this;this.pinsPaths.enter().append("path").attr("class","data").attr("d",function(t){return"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z M -2,-30"}).call(this._selection.enter.bind(this._selection)).on("click",function(t){o.click(o.rowToObj(t),"weight",o._selection.selected(this))}),this.pinsPaths.attr("stroke-width","1.5px").style("display",function(o){var e=t.project(o[0],o[1]);return e?null:"none"}).style("fill",function(t){return t[2]&&t[2].fillColor?t[2].fillColor:o.pinColor()}),this.pinsPaths.exit().remove()},r.prototype.layerZoomed=function(t){e.prototype.layerZoomed.apply(this,arguments),this.pinsPaths.attr("transform",function(o){var e=t.project(o[0],o[1]);return e||(e=[0,0]),"translate("+e[0]+", "+e[1]+")scale(0.5)"})},r.prototype.click=function(t,o,e){console.log("Click:  "+JSON.stringify(t)+", "+o+", "+e)},r});