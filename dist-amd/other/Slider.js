(function(e,t){typeof define=="function"&&define.amd?define(["d3","../common/SVGWidget","./ISlider","css!./Slider"],t):e.other_Slider=t(e.d3,e.common_SVGWidget,e.other_ISlider)})(this,function(e,t,n){function r(){t.call(this),n.call(this),this.selectionLabel(""),this.xScale=e.scale.linear().clamp(!0);var r=this;this.brush=e.svg.brush().x(this.xScale).extent([0,0]).on("brushstart",function(e){r.brushstart(e,this)}).on("brush",function(e){r.brushmove(e,this)}).on("brushend",function(e){r.brushend(e,this)}),this.brush.empty=function(){return!1},this.axis=e.svg.axis().scale(this.xScale).orient("bottom").tickFormat(function(e){return e}).tickSize(0).tickPadding(12)}return r.prototype=Object.create(t.prototype),r.prototype._class+=" other_Slider",r.prototype.implements(n.prototype),r.prototype.publish("fontSize",null,"number","Font Size",null,{tags:["Basic"]}),r.prototype.publish("fontFamily",null,"string","Font Name",null,{tags:["Basic"]}),r.prototype.publish("fontColor",null,"html-color","Font Color",null,{tags:["Basic"]}),r.prototype.publish("allowRange",!1,"boolean","Allow Range Selection",null,{tags:["Intermediate"]}),r.prototype.publish("low",0,"number","Low",null,{tags:["Intermediate"]}),r.prototype.publish("high",100,"number","High",null,{tags:["Intermediate"]}),r.prototype.publish("step",10,"number","Step",null,{tags:["Intermediate"]}),r.prototype.publish("selectionLabel","","string","Selection Label",null,{tags:["Intermediate"]}),r.prototype.testData=function(e){return this.columns("Percent"),this.data(66),this},r.prototype.testData2=function(e){return this.allowRange(!0),this.columns("Percent"),this.data([44,66]),this},r.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);return arguments.length&&this.brushg&&this.brushg.call(this.brush.extent(this.allowRange()?this._data:[this._data,this._data])),n},r.prototype.enter=function(t,n){(this.high()-this.low())/this.step()<=10&&this.axis.tickValues(e.merge([e.range(this.low(),this.high(),this.step()),[this.high()]])),this.axisElement=n.append("g").attr("class","x axis"),this.brushg=n.append("g").attr("class","brush").call(this.brush),this.brushg.select(".background").attr("y",-9).attr("height",18),this.brushg.select(".extent").attr("y","-10").attr("height","20"),this.brushg.selectAll(".resize").select("rect").attr("x",function(e){return e==="e"?0:-8}).attr("y","-10").attr("width","8").attr("height","20"),this.handle=this.brushg.selectAll(".resize").append("path").attr("class","handle").attr("transform","translate(0,-27)")},r.prototype.update=function(e,t){var n=this,r=this.width()-50;this.xScale.domain([this.low(),this.high()]).range([-r/2,r/2]),this.axisElement.call(this.axis),this.axisElement.selectAll(".tick > text").style("fill",this.fontColor()).style("font-size",this.fontSize()).style("font-family",this.fontFamily());var i=this.xScale.range();this.brushg.select(".background").attr("x",i[0]).attr("width",i[1]-i[0]),this.handle.attr("d",function(e){return n.handlePath(e)});if(this._initHandle===undefined){this._initHandle=!0;var s=[this.low(),this.low()];this.allowRange()&&this._data?s=this._data:this._data&&(s=[this._data,this._data]),this.brushg.call(this.brush.extent(s))}},r.prototype.brushstart=function(t,n){if(!e.event||!e.event.sourceEvent)return;e.event.sourceEvent.stopPropagation()},r.prototype.brushmove=function(t,n){if(!e.event||!e.event.sourceEvent)return;e.event.sourceEvent.stopPropagation();if(!this.allowRange()){var r=this.xScale.invert(e.mouse(n)[0]);e.select(n).call(this.brush.extent([r,r]))}},r.prototype.brushend=function(t,n){if(!e.event||!e.event.sourceEvent)return;e.event.sourceEvent.stopPropagation();if(!this.allowRange()){var r=this.nearestStep(this.xScale.invert(e.mouse(n)[0]));e.select(n).call(this.brush.extent([r,r])),this._data=r;if(this.selectionLabel()){var i={};i[this.selectionLabel()]=r,this.click(i)}else this.click(r)}else{var s=this.brush.extent();s[0]=this.nearestStep(s[0]),s[1]=this.nearestStep(s[1]),this._data=s,e.select(n).call(this.brush.extent(s)),this.newSelection(s[0],s[1])}},r.prototype.nearestStep=function(e){return this.low()+Math.round((e-this.low())/this.step())*this.step()},r.prototype.handlePath=function(e,t){var n=+(e==="e"),r=n?1:-1,i=this.allowRange()?.5:0,s=18,o="M"+i*r+","+s+"A6,6 0 0 "+n+" "+6.5*r+","+(s+6)+"V"+(2*s-6)+"A6,6 0 0 "+n+" "+i*r+","+2*s;return this.allowRange()?o+="ZM"+2.5*r+","+(s+8)+"V"+(2*s-8)+"M"+4.5*r+","+(s+8)+"V"+(2*s-8):o+="M"+1*r+","+(s+8)+"V"+(2*s-8),o},r});