!function(t,e){"function"==typeof define&&define.amd?define(["d3","./Table","../common/Palette","css!./Legend"],e):t.other_Legend=e(t.d3,t.other_Table,t.common_Palette)}(this,function(t,e,i){function o(){e.call(this),this._tag="div",this.showHeader(!1)}function r(t){return'<div class="colorBlock" style="background-color:'+t+';"></div>'}function a(t){for(var e=t.toString().split(".")[0],i=t.toString().split(".")[1];/(\d+)(\d{3})/.test(e.toString());)e=e.toString().replace(/(\d+)(\d{3})/,"$1,$2");return"undefined"!=typeof i?e+"."+i:e}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" other_Legend",o.prototype.publish("dataFamily","ND","set","Type of data",["1D","2D","ND","any"],{tags:["Private"]}),o.prototype.publish("orientation","vertical","set","Orientation of Legend rows",["vertical","horizontal"],{tags:["Private"]}),o.prototype.targetWidget=function(t){if(!arguments.length)return this._targetWidget;this._targetWidget=t,this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor);var e=this;return this._targetWidgetMonitor=this._targetWidget.monitor(function(t,i,o,r){switch(t){case"chart":case"columns":case"data":case"paletteID":e.lazyRender()}}),this},o.prototype.getWidget=function(){if(this._targetWidget)switch(this._targetWidget.classID()){case"chart_MultiChart":return this._targetWidget.chart()}return this._targetWidget},o.prototype.getPalette=function(){var t=this.getWidget();if(t&&t._palette)switch(t._palette.type()){case"ordinal":return i.ordinal(t._palette.id());case"rainbow":return i.rainbow(t._palette.id())}return i.ordinal("default")},o.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments),this.renderHtmlDataCells(!0),this.fixedHeader(!1),this.fixedSize(!0),i.classed("other_Legend",!0)},o.prototype.update=function(t,i){var o=["Key","Label"],n=[];if(this._targetWidget){var s=this.getPalette();switch(s.type()){case"ordinal":switch(this.dataFamily()){case"2D":n=this._targetWidget.data().map(function(t){return[r(s(t[0])),t[0]]},this);break;case"ND":var l=this._targetWidget.columns();n=l.filter(function(t,e){return e>0}).map(function(t){return[r(s(t)),t]},this)}break;case"rainbow":for(var d=s.colors().reverse(),g=d.length,h=this._targetWidget._dataMinWeight,c=this._targetWidget._dataMaxWeight,p=0;g>p;p++){var u,f,y=parseInt((c-h)/g);0===p?(f=a(h+y*(p+1)),n.push([r(d[p]),"0 - "+f])):p+1===g?(u=a(h+y*p+1),n.push([r(d[p]),u+"+"])):(u=a(h+y*p+1),f=a(h+y*(p+1)),n.push([r(d[p]),u+" - "+f]))}}}this.columns(o),this.data(n),e.prototype.update.apply(this,arguments),i.classed("horiz-legend","horizontal"===this.orientation());var _=i.select(".tableDiv > table"),v=_.node().getBoundingClientRect(),m=this._parentElement.node().getBoundingClientRect();i.select(".tableDiv").style({overflow:"visible"});var W=m.height/2-v.height/2,b=m.width/2-v.width/2;_.style({position:"absolute",top:W+"px",left:b+"px"});var w=this.pageNumber()-1,D=this.itemsPerPage(),M=w*D,x=parseInt(w*D)+parseInt(D),k=null;k=this.pagination()?this.data().slice(M,x):this.data();var L=this.tbody.selectAll("tr").data(k),P=this;L.on("click",function(t,e){P.onClick(t,e)}).on("mouseover",function(t,e){P.onMouseOver(t,e)})},o.prototype.exit=function(t,i){this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor),e.prototype.exit.apply(this,arguments)},o.prototype.onClick=function(t,e){console.log("Legend onClick method"),console.log("rowData: "+t),console.log("rowIdx: "+e)},o.prototype.onMouseOver=function(t,e){console.log("Legend onMouseOver method"),console.log("rowData: "+t),console.log("rowIdx: "+e)},o});